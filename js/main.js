!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";n(13),n(7),n(16),n(1),n(6),n(10),n(9),n(14),n(23),n(17),n(2),n(5),n(22),n(3),n(8),n(12),n(15),n(11),n(18),n(4),n(19),n(21),n(20)},function(e,t){"use strict";function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}function r(e){e.parentElement.removeChild(e)}function i(e,t){var n=Array.from(document.querySelectorAll("."+e+"."+t));n.forEach(function(e){e.classList.remove(t)})}function a(e,t){for(;e;){var n=e.getAttribute(t);if(n)return{elementRef:e,attrValue:n};e=e.parentElement}}function o(e,t){var n=document.getElementById(t);return!!n&&!n.contains(e)}function l(e){var t=e%60;return t<10?"0"+t:t}function s(e){var t=Math.floor(e/60%60);return e>=3600&&t<10?"0"+t:t}function c(e){var t=Math.floor(e/3600);return e>=3600?t+":":""}function u(e){var t=l(e),n=s(e),r=c(e);return""+r+n+":"+t}function d(e,t){var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)}Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e){return t.includes(e.src)?Promise.resolve():new Promise(function(n){var r=document.createElement("script");Object.keys(e).forEach(function(t){r.setAttribute(t,e[t])}),document.getElementsByTagName("body")[0].appendChild(r),t.push(e.src),r.onload=n})}var t=[];return{load:e}}();t.scriptLoader=f,t.capitalize=n,t.getElementByAttr=a,t.removeElement=r,t.removeElementClass=i,t.formatTime=u,t.isOutsideElement=o,t.dispatchEvent=d},function(e,t){"use strict";function n(){return E}function r(e){return E[e]}function i(e){return E[e.id]=Object.assign({sortedBy:"",order:0,shuffled:!1,tracks:[],playbackIndex:0,playbackOrder:[]},e),E[e.id]}function a(e){delete E[e]}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";I=e}function l(){return I}function s(e){return e===I}function c(){return E[I]}function u(e){return e?Object.assign({},e):null}function d(e){j=u(e)}function f(){return j}function m(e){j.index=e}function v(e,t){var n=r(e),i=n?n.tracks.find(function(e){return e.name===t}):null;return u(i)}function p(e){var t=c();t.playbackIndex=t.playbackOrder.indexOf(Number.parseInt(e,10))}function y(){var e=f();e&&p(e.index)}function g(e){for(var t=e.length;t;){var n=Math.floor(Math.random()*t);t-=1;var r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}return e}function b(e,t){var n=e.map(function(e){return e.index});return t?g(n):n}function k(e,t){e.shuffled=t,e.playbackOrder=b(e.tracks,t),y()}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.playbackIndex+=t,e.playbackIndex>=e.playbackOrder.length?e.playbackIndex=0:e.playbackIndex===-1&&(e.playbackIndex=e.playbackOrder.length-1),e.playbackOrder[e.playbackIndex]}function T(e,t){var n=h(e,t);return u(e.tracks[n])}function P(e){return e.map(function(e,t){return e.index=t,e})}Object.defineProperty(t,"__esModule",{value:!0});var E={},I="",j=null;t.setPlaylistAsActive=o,t.getPlaylistById=r,t.removePlaylist=a,t.getAllPlaylists=n,t.createPlaylist=i,t.isActive=s,t.getActivePlaylist=c,t.getActivePlaylistId=l,t.getTrack=u,t.setCurrentTrack=d,t.getCurrentTrack=f,t.updateCurrentTrackIndex=m,t.findTrack=v,t.getNextTrack=T,t.setPlaybackIndex=p,t.shufflePlaybackOrder=k,t.resetTrackIndexes=P},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e){E.shufflePlaybackOrder(e,(0,w.getSetting)("shuffle")),e.sortedBy&&((0,M.sortTracks)(e.tracks,e.sortedBy,e.order),c(e))}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:T.isActive("manage"),n="playlist/"+e.id;T.add(n),j.add(e),(0,A.createSidebarEntry)(e.title,e.id),(0,C.createPlaylistEntry)(e.title,e.id,e.url),a(e),t&&T.toggle(n)}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T.isActive("manage"),r="playlist/"+e.id;e.tracks=E.resetTrackIndexes(e.tracks),j.append(e,t),a(e),n?T.toggle(r):(0,B.dispatchEvent)("track-length-change",e.tracks)}function s(e){var t=S.storedTrack.get();t&&t.playlistId===e&&S.storedTrack.remove(),E.isActive(e)&&(0,S.stopPlayer)(),E.removePlaylist(e),(0,A.removeSidebarEntry)(e),j.remove(e),(0,x.postMessageToWorker)({action:"remove",playlistId:e})}function c(e){var t=E.getCurrentTrack();if((0,B.removeElementClass)("track","selected"),j.update(e),t&&E.isActive(e.id)){var n=E.findTrack(e.id,t.name);n&&(E.updateCurrentTrackIndex(n.index),E.setPlaybackIndex(n.index),j.showPlayingTrack(n.index,e.id,!0))}}function u(e,t,n){var r;(r=e.tracks).push.apply(r,i(t)),document.getElementById("js-"+e.id)?l(e,t):o(e),(0,O.removeImportOptionMask)(n),(0,x.postMessageToWorker)({action:"put",playlist:e})}function d(e){return e.map(function(e){return Number.parseInt(e.getAttribute("data-index"),10)})}function f(e){e.forEach(function(e){(0,B.removeElement)(e)})}function m(e){e.forEach(function(e,t){e.setAttribute("data-index",t)})}function v(e,t){var n=e.tracks.filter(function(e){return!t.includes(e.index)});return E.resetTrackIndexes(n)}function p(e,t){var n=E.getCurrentTrack();if(n&&E.isActive(e))if(t.includes(n.index))E.updateCurrentTrackIndex(-1);else{var r=E.findTrack(e,n.name),i=r.index;E.updateCurrentTrackIndex(i)}}function y(){return Array.from(document.querySelectorAll(".track.selected"))}function g(e){var t=y();if(t.length){var n=d(t);f(t),m(Array.from(document.getElementById("js-"+e.id).children)),e.tracks=v(e,n),E.shufflePlaybackOrder(e,(0,w.getSetting)("shuffle")),p(e.id,n),(0,B.dispatchEvent)("track-length-change",e.tracks),(0,x.postMessageToWorker)({action:"put",playlist:e})}}function b(e){var t=e.target,n=E.createPlaylist({id:Math.random().toString(36).slice(2),title:t.title.value,type:"list"});o(n),(0,x.postMessageToWorker)({action:"put",playlist:n}),e.preventDefault(),t.reset()}function k(e,t,n){var r='\n        <form id="js-'+e+'-form" class="'+e+'-form">\n            <input type="text" name="title" autocomplete="off" required>\n            <button class="btn">Create</button>\n        </form>\n    ';t.insertAdjacentHTML("afterend",r),document.getElementById("js-"+e+"-form").addEventListener("submit",n)}Object.defineProperty(t,"__esModule",{value:!0}),t.createNewPlaylistInputForm=t.onNewPlaylistFormSubmit=t.getSelectedTrackElements=t.getSelectedTrackIndexes=t.updatePlaylist=t.refreshPlaylist=t.removePlaylist=t.appendToPlaylist=t.initPlaylist=void 0;var h=n(16),T=r(h),P=n(2),E=r(P),I=n(8),j=r(I),w=n(13),L=n(6),B=n(1),x=n(7),A=n(9),S=n(4),M=n(12),C=n(22),O=n(5);window.addEventListener("keypress",function(e){var t="Delete"===e.key||127===e.keyCode,n=E.getPlaylistById((0,L.getVisiblePlaylistId)());t&&n&&g(n)}),t.initPlaylist=o,t.appendToPlaylist=l,t.removePlaylist=s,t.refreshPlaylist=c,t.updatePlaylist=u,t.getSelectedTrackIndexes=d,t.getSelectedTrackElements=y,t.onNewPlaylistFormSubmit=b,t.createNewPlaylistInputForm=k},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){(0,I.showTrackInfo)(e),x.showTrackDuration(e.duration),e.index!==-1&&(0,j.showPlayingTrack)(e.index,t,n),n=!1}function a(e){var t=L.getCurrentTrack(),n=L.getActivePlaylistId(),r={currentTime:e,duration:t.durationInSeconds};V=!1,i(t,n,R),(0,I.showActiveIcon)(n),x.togglePlayBtn(V),N.saveTrack({playlistId:n,name:t.name,player:t.player}),x.elapsedTime.start(r)}function o(e){var t=e.play,n=e.pause;V?t():(n(),(0,I.removeActiveIcon)(),x.elapsedTime.stop(),x.togglePlayBtn(!V)),V=!V}function l(e){var t=null;"native"===e.player?t=S.getPlayPauseCallbacks(e):"youtube"===e.player?t=C.getPlayPauseCallbacks():"soundcloud"===e.player&&(t=_.getPlayPauseCallbacks()),o(t)}function s(e,t){var n=(0,E.getSetting)("volume");L.setPlaybackIndex(e.index),"native"===e.player?S.playTrack(e,n,t):"youtube"===e.player?C.playTrack(e,n,t):"soundcloud"===e.player&&_.playTrack(e,n,t)}function c(e,t){var n=(0,P.getVisiblePlaylistId)();n&&(L.setPlaylistAsActive(n),f(e,t))}function u(){var e=L.getCurrentTrack();return e?void l(e):void c("direction")}function d(e,t,n){var r=null;return"index"===t?r=L.getTrack(e.tracks[n]):"direction"===t&&(r=L.getNextTrack(e,n),R=!0),r?void s(r):void g()}function f(e,t){var n=L.getCurrentTrack(),r=L.getActivePlaylistId();if(r){var i=L.getPlaylistById(r),a=(0,E.getSetting)("shuffle");n&&p(n),i.shuffled!==a&&L.shufflePlaybackOrder(i,a),d(i,e,t)}}function m(){f("direction",1)}function v(){f("direction",-1)}function p(e,t){t||"native"!==e.player?"youtube"===e.player?C.stopTrack():"soundcloud"===e.player&&_.stopTrack():S.stopTrack(e)}function y(e){var t=L.getCurrentTrack();t&&p(t,e),g(e)}function g(e){e||(L.setCurrentTrack(),L.setPlaylistAsActive(),(0,I.showTrackInfo)()),V=!0,x.resetTrackBar(),x.showTrackDuration(),x.togglePlayBtn(V),(0,I.removeActiveIcon)(),(0,T.removeElementClass)("track","playing")}function b(e){var t=L.getActivePlaylist();t&&L.shufflePlaybackOrder(t,e)}function k(e,t){"native"===e.player?S.setVolume(t,e):"youtube"===e.player?C.setVolume(t):"soundcloud"===e.player&&_.setVolume(t)}function h(e,t){var n=Math.floor(e.durationInSeconds/100*t);x.elapsedTime.stop(),"native"===e.player?S.seekTo(n,e):"youtube"===e.player?C.seekTo(n):"soundcloud"===e.player&&_.seekTo(n),x.displayCurrentTime(n)}Object.defineProperty(t,"__esModule",{value:!0}),t.storedTrack=t.onTrackStart=t.setVolume=t.seekTo=t.toggleShuffle=t.stopPlayer=t.playPreviousTrack=t.playNextTrack=t.playTrack=void 0;var T=n(1),P=n(6),E=n(13),I=n(9),j=n(8),w=n(2),L=r(w),B=n(18),x=r(B),A=n(19),S=r(A),M=n(21),C=r(M),O=n(20),_=r(O),V=!0,R=!1,N=function(){function e(){return JSON.parse(localStorage.getItem("track"))||{}}function t(e){localStorage.setItem("track",JSON.stringify(e))}function n(n){var r=Object.assign(e(),n);t(r)}function r(){localStorage.removeItem("track")}function a(e){if(e){var t=L.findTrack(e.playlistId,e.name);if(!t)return void r(t);L.setPlaylistAsActive(e.playlistId),x.setTrackBarInnerWidth(e.elapsed),x.displayCurrentTime(e.currentTime),i(t,e.playlistId),s(t,e.currentTime)}}function o(t){if(!c){var n=e();l[t]=!0,(t===n.player||Object.keys(l).every(function(e){return l[e]}))&&(c=!0,a(n))}}var l={native:!1,youtube:!1,soundcloud:!1},c=!1;return{get:e,remove:r,saveTrack:t,updateSavedTrack:n,setPlayerAsReady:o}}();document.getElementById("js-tab-container").addEventListener("dblclick",function(e){var t=e.target,n=(0,T.getElementByAttr)(t,"data-index");n&&c("index",n.attrValue)}),window.addEventListener("track-end",function(){return(0,E.getSetting)("once")?void y(!0):(0,E.getSetting)("repeat")?void s(L.getCurrentTrack()):void m()}),t.playTrack=u,t.playNextTrack=m,t.playPreviousTrack=v,t.stopPlayer=y,t.toggleShuffle=b,t.seekTo=h,t.setVolume=k,t.onTrackStart=a,t.storedTrack=N},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";A=e}function o(e){return A!==e}function l(e){var t=Array.from(document.querySelectorAll("[data-option-id*="+e+"]"));t.forEach(function(t){t.parentElement.insertAdjacentHTML("beforeend",'\n            <div class="option-mask" data-mask-id='+e+'>\n                <span class="icon-spin4 animate-spin"></span>\n            </div>\n        ')})}function s(e){var t=Array.from(document.querySelectorAll("[data-mask-id*="+e+"]"));t.forEach(function(e){(0,T.removeElement)(e)})}function c(e,t){var n=Array.from(document.querySelectorAll("[data-mask-id*="+e+"]"));n.forEach(function(e){var n=e.children[0];(0,T.removeElement)(n),e.insertAdjacentHTML("beforeend","<span>"+t+"</span>")}),setTimeout(function(){s(e)},3200)}function u(e){e.includes("youtube")?L.fetchPlaylist(e):e.includes("soundcloud")&&x.fetchPlaylist(e)}function d(e,t){return e.reduce(function(e,n){var r=t.some(function(e){return e.name===n.name});return r||e.push(n),e},[])}function f(e){return e.length?new Promise(function(t){var n=0;e.forEach(function(r){var i=new Image;i.onload=function(){n+=1,n===e.length&&t(e)},i.onerror=function(){r.thumbnail="assets/images/album-art-placeholder.png",n+=1,n===e.length&&t(e)},i.src=r.thumbnail})}):Promise.resolve(e)}function m(e){var t=e.tracks.splice(0),n=(0,P.getPlaylistById)(e.id)||(0,P.createPlaylist)(e),r=d(t,n.tracks);f(r).then(function(t){(0,E.updatePlaylist)(n,t,e.player)})}function v(e){var t="js-import-form",n="\n        <form id="+t+' class="import-form">\n            <input type="text" name="playlist-url" class="input" placeholder="Playlist url">\n            <button class="btn">Import</button>\n        </form>\n    ';e.insertAdjacentHTML("beforeend",n);var r=document.getElementById(t);r.elements["playlist-url"].focus(),r.addEventListener("submit",h)}function p(){var e=document.getElementById("js-import-form");e&&(e.removeEventListener("submit",h),(0,T.removeElement)(e),(0,T.removeElementClass)("import-option-btn","active"))}function y(e){e.classList.add("active"),v(e)}function g(e){var t=e.target;(0,j.selectLocalFiles)([].concat(i(t.files))),t.value="",t.removeEventListener("change",g),(0,T.removeElement)(t)}function b(){var e=document.createElement("input");return e.setAttribute("type","file"),e.setAttribute("id","js-file-picker"),e.classList.add("file-picker"),e.addEventListener("change",g),document.body.appendChild(e),e}function k(e){var t=document.getElementById("js-file-picker")||b(),n=new MouseEvent("click");"local-file"===e?(t.removeAttribute("webkitdirectory"),t.removeAttribute("directory"),t.setAttribute("multiple",!0)):"local-folder"===e&&(t.removeAttribute("multiple"),t.setAttribute("webkitdirectory",!0),t.setAttribute("directory",!0)),t.dispatchEvent(n)}function h(e){var t=e.target.elements["playlist-url"].value.trim();t&&(l(A),u(t),e.target.reset()),e.preventDefault()}Object.defineProperty(t,"__esModule",{value:!0}),t.removeImportOptionMask=t.createImportOptionMask=t.showNotice=t.addImportedPlaylist=t.importPlaylist=t.setOption=void 0;var T=n(1),P=n(2),E=n(3),I=n(24),j=n(14),w=n(23),L=r(w),B=n(17),x=r(B),A="";document.getElementById("js-import-options").addEventListener("mouseover",function e(t){var n=t.target,r=(0,T.getElementByAttr)(n,"data-option-id");if(r){var i=r.attrValue;"dropbox"===i&&(this.removeEventListener("mouseover",e),T.scriptLoader.load({src:"https://www.dropbox.com/static/api/2/dropins.js",id:"dropboxjs","data-app-key":"6ur73hspbv8o1z9"}))}}),document.getElementById("js-import-options").addEventListener("click",function(e){var t=e.target,n=(0,T.getElementByAttr)(t,"data-option-id");if(n){var r=n.attrValue;o(r)&&(a(r),p(),r.includes("local")?(k(r),a()):"dropbox"===r?(0,I.showDropboxChooser)():y(n.elementRef))}}),t.setOption=a,t.importPlaylist=u,t.addImportedPlaylist=m,t.showNotice=c,t.createImportOptionMask=l,t.removeImportOptionMask=s},function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";p=e}function i(){return p}function a(e){var t=document.getElementById("js-tab-container"),n=document.getElementById("js-tab-header"),r=document.getElementById("js-tab-footer");t.classList[e]("is-playlist-tab-visible"),n.classList[e]("visible"),r.classList[e]("visible")}function o(e,t,n){if((0,l.removeElementClass)("sidebar-btn","active"),(0,l.removeElementClass)("tab","active"),t){var i=(0,u.getPlaylistById)(e);r(e),(0,d.togglePlaylistTypeBtn)(i.type),(0,m.setSortOptions)(i),(0,f.enableTrackSelection)(i.id),a("add"),(0,l.dispatchEvent)("track-length-change",i.tracks)}else r(),a("remove");if((0,d.resetFilteredPlaylist)(),document.getElementById("js-tab-"+e).classList.add("active"),!n){var o=(0,s.getSidebarEntry)(e);o.classList.add("active")}}Object.defineProperty(t,"__esModule",{value:!0}),t.getVisiblePlaylistId=t.setVisiblePlaylistId=t.toggleTab=void 0;var l=n(1),s=n(9),c=n(10),u=n(2),d=n(8),f=n(15),m=n(12),v=n(11),p="";window.addEventListener("click",function(e){var t=e.target.getAttribute("data-header-item"),n=(0,u.getPlaylistById)(i()),r="";"move-to"===t?(r="js-move-to-panel",(0,c.togglePanel)(r,n,v.createMoveToPanel)):"list"!==t&&"grid"!==t||t===n.type?"sorting"===t?(r="js-sort-panel",(0,c.togglePanel)(r,n,m.createSortPanel)):"order"===t&&n.sortedBy&&(0,m.changePlaylistOrder)(n):(0,d.changePlaylistType)(t,n),(0,f.deselectTrackElements)(e.target),(0,c.removePresentPanels)(e,r)}),t.toggleTab=o,t.setVisiblePlaylistId=r,t.getVisiblePlaylistId=i},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){d.postMessage(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.postMessageToWorker=void 0;var a=n(16),o=r(a),l=n(1),s=n(2),c=n(3),u=n(4),d=null;!function(){d=new Worker("js/ww.js"),d.onmessage=function(e){var t=e.data;if("init-playlist"===t.action)!function(){var e=t.payload;Object.keys(e).forEach(function(t){var n=e[t];"youtube"===n.player&&l.scriptLoader.load({src:"https://www.youtube.com/iframe_api"}),(0,c.initPlaylist)((0,s.createPlaylist)(n),!1)}),u.storedTrack.setPlayerAsReady("native"),u.storedTrack.setPlayerAsReady("soundcloud"),o.toggleCurrent()}();else if("update-playlist"===t.action){var n=(0,s.getPlaylistById)(t.payload.id);n._id=t.payload._id}},d.onerror=function(e){console.log(e)}}(),t.postMessageToWorker=i},function(e,t,n){"use strict";function r(e){return'\n        <li class="list-item track" data-index="'+e.index+'">\n            <span>'+e.title+"</span>\n            <span>"+e.artist+"</span>\n            <span>"+e.album+"</span>\n            <span>"+e.duration+"</span>\n        </li>\n    "}function i(e,t){return'\n        <ul class="list-view-header">\n            <li class="list-view-header-item">TITLE</li>\n            <li class="list-view-header-item">ARTIST</li>\n            <li class="list-view-header-item">ALBUM</li>\n            <li class="list-view-header-item">LENGTH</li>\n        </ul>\n        <ul id="js-'+e+'" class="playlist-items list-view">'+t+"</ul>\n    "}function a(e){return'\n        <li class="grid-item track" data-index="'+e.index+'">\n            <div class="grid-item-thumb-container">\n                <div class="grid-item-duration">'+e.duration+'</div>\n                <img src="'+e.thumbnail+'" class="grid-item-thumb">\n            </div>\n            <div>'+e.name+"</div>\n        </li>\n    "}function o(e,t){return'<ul id="js-'+e+'" class="playlist-items grid-view">'+t+"</ul>"}function l(e,t){return e.map(t).join("")}function s(e){return"list"===e.type?i(e.id,l(e.tracks,r)):o(e.id,l(e.tracks,a))}function c(e){var t=s(e);return'<div id="js-tab-'+e.id+'" class="tab">'+t+"</div>"}function u(e){var t=c(e),n=document.getElementById("js-tab-container");n.insertAdjacentHTML("beforeend",t)}function d(e,t){var n=document.getElementById("js-"+e.id),i="list"===e.type?r:a;n.insertAdjacentHTML("beforeend",l(t,i))}function f(e,t){t[0].textContent=e.title,t[1].textContent=e.artist,t[2].textContent=e.album,t[3].textContent=e.duration}function m(e,t){t[0].children[0].textContent=e.duration,t[0].children[1].setAttribute("src",e.thumbnail),t[1].textContent=e.name}function v(e){var t=document.getElementById("js-"+e.id).children,n="list"===e.type?f:m;e.tracks.forEach(function(e,r){var i=t[r].children;e.index=r,n(e,i)})}function p(e){var t=document.getElementById("js-tab-"+e);(0,B.removeElement)(t)}function y(e,t){var n=e.offsetHeight,r=e.offsetTop,i=t.scrollTop,a=t.clientHeight,o=i+a;(r-n<i||r>o)&&(t.scrollTop=r-a/2)}function g(e,t,n){var r=document.getElementById("js-"+t),i=r.children[e];(0,B.removeElementClass)("track","playing"),i.classList.add("playing"),n&&y(i,r)}function b(e,t,n){e.forEach(function(e){var r=t[e.index],i="\n            "+e.title.toLowerCase()+"\n            "+e.artist.toLowerCase()+"\n            "+e.album.toLowerCase()+"\n        ";i.includes(n)?r.classList.remove("hidden"):r.classList.add("hidden")})}function k(e){var t=document.getElementById("js-list-toggle-btn"),n=document.getElementById("js-grid-toggle-btn");"list"===e?(t.classList.add("active"),n.classList.remove("active")):(n.classList.add("active"),t.classList.remove("active"))}function h(e,t){if(t.type=e,(0,x.resetPlaylistSort)(t),document.getElementById("js-tab-"+t.id).innerHTML=s(t),(0,A.enableTrackSelection)(t.id),k(e),(0,S.hideMoveToBtn)(),(0,w.postMessageToWorker)({action:"update",playlist:{id:t.id,type:t.type,sortedBy:t.sortedBy,order:t.order}}),t.id===(0,L.getActivePlaylistId)()){var n=(0,L.getCurrentTrack)();n&&g(n.index,t.id,!0)}}function T(e){return e.reduce(function(e,t){return e+=t.durationInSeconds},0)}function P(e,t){return t=e>1||!e?t+"s":t,e+" "+t}function E(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],n=(0,L.getPlaylistById)(t),r=n.tracks,i=document.getElementById("js-"+t).children;C=e?t:"",b(r,i,e)}function I(){C&&(document.getElementById("js-filter-input").value="",E("",C))}Object.defineProperty(t,"__esModule",{value:!0}),t.resetFilteredPlaylist=t.changePlaylistType=t.togglePlaylistTypeBtn=t.filterTracks=t.showPlayingTrack=t.append=t.update=t.remove=t.add=void 0;var j=n(6),w=n(7),L=n(2),B=n(1),x=n(12),A=n(15),S=n(11),M=0,C="";document.getElementById("js-filter-input").addEventListener("keyup",function(e){var t=e.target;M&&clearTimeout(M),M=setTimeout(function(){E(t.value.trim().toLowerCase(),(0,j.getVisiblePlaylistId)())},400)}),window.addEventListener("track-length-change",function(e){var t=e.detail,n=document.getElementById("js-tab-footer"),r=T(t),i=P(t.length,"track"),a=P(Math.floor(r/60%60),"minute");if(r>3600){var o=P(Math.floor(r/3600),"hour");a=o+" and "+a}n.textContent=i+", "+a+" of playtime"}),t.add=u,t.remove=p,t.update=v,t.append=d,t.showPlayingTrack=g,t.filterTracks=b,t.togglePlaylistTypeBtn=k,t.changePlaylistType=h,t.resetFilteredPlaylist=I},function(e,t,n){"use strict";function r(e){return document.getElementById("js-sidebar-entry-"+e)}function i(e,t){var n=document.getElementById("js-sidebar-entries"),r='\n        <li>\n            <a href="#/playlist/'+t+'" id="js-sidebar-entry-'+t+'"\n                class="btn btn-transparent sidebar-btn">'+e+"</a>\n        </li>\n    ";n.insertAdjacentHTML("beforeend",r)}function a(e,t){var n=r(e);n.textContent=t}function o(e){var t=r(e);(0,k.removeElement)(t)}function l(){return'<span id="js-active-playlist-icon" class="icon-volume-up active-playlist-icon"></span>'}function s(e){var t=r(e);c(),t.insertAdjacentHTML("beforeend",l())}function c(){var e=document.getElementById("js-active-playlist-icon");e&&(0,k.removeElement)(e)}function u(e,t,n){var r=Number.parseInt(e.style.left||0,10);e.style.left=Math.abs(r)<t+10?r-1+"px":n+"px",T=requestAnimationFrame(function(){u(e,t,n)})}function d(e){var t=e.target,n=t.scrollWidth,r=t.parentElement.offsetWidth-8;n>r&&(this.addEventListener("mouseleave",f),P=setTimeout(function(){u(t,n,r)},400))}function f(e){var t=e.target;this.removeEventListener("mouseleave",f),clearTimeout(P),cancelAnimationFrame(T),t.style.left=0}function m(){var e='\n        <div id="js-track-info">\n            <div class="track-art-container">\n                <img src="" id="js-track-art" class="track-art" alt="track art">\n            </div>\n            <div class="track-name">\n                <div id="js-track-title" class="track-title"></div>\n                <div id="js-track-artist" class="track-artist"></div>\n            </div>\n        </div>\n    ';document.querySelector(".sidebar").insertAdjacentHTML("beforeend",e),document.getElementById("js-track-title").addEventListener("mouseenter",d),document.getElementById("js-track-artist").addEventListener("mouseenter",d)}function v(e){var t=document.getElementById("js-track-art"),n=e.thumbnail||"assets/images/album-art-placeholder.png";t.src="object"===("undefined"==typeof n?"undefined":b(n))?URL.createObjectURL(n):n}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";document.getElementById("js-track-title").textContent=t,document.getElementById("js-track-artist").textContent=e}function y(e){var t=document.getElementById("js-track-info");return e?(t||m(),e.artist&&e.title?(p(e.artist,e.title),document.title=e.artist+" - "+e.title):(p(e.name),document.title=e.name),void v(e)):(t&&(document.getElementById("js-track-title").removeEventListener("mouseenter",d),document.getElementById("js-track-artist").removeEventListener("mouseenter",d),(0,k.removeElement)(t)),void(document.title="Veery"))}function g(){var e=document.getElementById("js-sidebar-form");return e?void(0,k.removeElement)(e):void(0,h.createNewPlaylistInputForm)("sidebar",this,h.onNewPlaylistFormSubmit)}Object.defineProperty(t,"__esModule",{value:!0}),t.removeActiveIcon=t.showActiveIcon=t.showTrackInfo=t.getSidebarEntry=t.removeSidebarEntry=t.editSidebarEntry=t.createSidebarEntry=void 0;var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k=n(1),h=n(3),T=0,P=0;document.getElementById("js-sidebar-form-toggle-btn").addEventListener("click",g),t.createSidebarEntry=i,t.editSidebarEntry=a,t.removeSidebarEntry=o,t.getSidebarEntry=r,t.showTrackInfo=y,t.showActiveIcon=s,t.removeActiveIcon=c},function(e,t,n){"use strict";function r(e){c[e]=!0}function i(e){var t=document.getElementById(e);(0,s.removeElement)(t),c[e]=!1}function a(e){return c[e]}function o(e,t,n){a(e)?i(e):(r(e),n(e,t))}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];Object.keys(c).forEach(function(n){c[n]&&n!==t&&(0,s.isOutsideElement)(e.target,n)&&i(n)})}Object.defineProperty(t,"__esModule",{value:!0}),t.togglePanel=t.removePresentPanels=void 0;var s=n(1),c={};t.removePresentPanels=l,t.togglePanel=o},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(){if(!document.getElementById("js-move-to-btn")){var e='\n        <button id="js-move-to-btn" class="btn" data-header-item="move-to" title="Move to">Move to</button>\n    ';k.insertAdjacentHTML("beforeend",e)}}function a(){var e=document.getElementById("js-move-to-btn");e&&(0,f.removeElement)(e)}function o(e){var t=document.getElementById("js-move-to-list");b.onNewPlaylistFormSubmit(e),t.classList.remove("hidden"),t.innerHTML=u((0,m.getVisiblePlaylistId)())}function l(e){b.createNewPlaylistInputForm("move-to",this,o),(0,f.removeElement)(this),e.stopPropagation()}function s(e){var t,n=b.getSelectedTrackElements(),r=b.getSelectedTrackIndexes(n),i=(0,y.getPlaylistById)((0,m.getVisiblePlaylistId)()),a=(0,y.getPlaylistById)(e),o=[];i.tracks.forEach(function(t){r.includes(t.index)&&!(0,y.findTrack)(e,t.name)&&o.push(t)}),(t=a.tracks).push.apply(t,o),a.tracks=(0,y.resetTrackIndexes)(a.tracks),b.appendToPlaylist(a,o,!0),(0,p.postMessageToWorker)({action:"put",playlist:a})}function c(e){var t=(0,f.getElementByAttr)(e.target,"data-item");if(t){var n=t.attrValue;s(n),document.getElementById("js-move-to-list").removeEventListener("click",c),(0,v.removePresentPanels)()}}function u(e){var t=(0,y.getAllPlaylists)();return Object.keys(t).filter(function(t){return t!==e}).map(function(e){var n=t[e];return'\n            <li class="move-to-list-item" data-item="'+n.id+'">\n                <button class="btn">'+n.title+"</button>\n            </li>\n        "}).join("")}function d(e,t){var n=t.id,r=u(n),i=r?"":"hidden",a='\n        <div id="'+e+'" class="move-to-panel">\n            <h2 class="move-to-panel-title">Move to</h2>\n            <ul id="js-move-to-list" class="move-to-list '+i+'">'+r+'</ul>\n            <button id="js-move-to-new-pl-btn" class="btn move-to-new-pl-btn">Create new playlist</button>\n        </div>\n    ';k.insertAdjacentHTML("beforeend",a),document.getElementById("js-move-to-list").addEventListener("click",c),document.getElementById("js-move-to-new-pl-btn").addEventListener("click",l,{once:!0})}Object.defineProperty(t,"__esModule",{value:!0}),t.createMoveToPanel=t.hideMoveToBtn=t.showMoveToBtn=void 0;var f=n(1),m=n(6),v=n(10),p=n(7),y=n(2),g=n(3),b=r(g),k=document.getElementById("js-move-to-panel-container");t.showMoveToBtn=i,t.hideMoveToBtn=a,t.createMoveToPanel=d},function(e,t,n){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Sorting";document.getElementById("js-sort-toggle").textContent=e}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=document.getElementById("js-order-toggle");1===e?t.classList.remove("icon-up-big"):t.classList.add("icon-up-big")}function a(e,t,n){e.sort(function(e,r){var i="duration"===t?e.durationInSeconds:e[t].toLowerCase(),a="duration"===t?r.durationInSeconds:r[t].toLowerCase();return i<a?-1*n:i>a?n:0})}function o(e,t){e.order=e.sortedBy===t&&1===e.order?-1:1,e.sortedBy=t,a(e.tracks,t,e.order)}function l(e,t){var n=document.getElementById("js-filter-input").value;if(o(e,t),(0,h.refreshPlaylist)(e),(0,b.postMessageToWorker)({action:"put",playlist:e}),n){var r=document.getElementById("js-"+e.id).children;(0,T.filterTracks)(e.tracks,r,n)}}function s(e){var t=e.sortedBy,n=e.order,a="Sorting";t&&(a=(0,p.capitalize)(t)),r(a),i(n)}function c(e){return"list"===e?["title","artist","album","duration"]:["name","duration"]}function u(e){e.sortedBy="",e.order=0,r(),i()}function d(e,t){return e.map(function(e){var n=e===t?"active":"";return'\n            <li class="sort-option">\n                <button class="btn btn-transparent '+n+'" data-sort="'+e+'">\n                    '+(0,p.capitalize)(e)+"\n                </button>\n            </li>\n        "}).join("")}function f(e,t){var n=t.type,r=t.sortedBy,i=c(n),a=d(i,r),o='\n        <ul id="'+e+'" class="sort-panel">'+a+"</ul>\n    ";document.getElementById("js-sort-panel-container").insertAdjacentHTML("beforeend",o),document.getElementById(e).addEventListener("click",v)}function m(e){l(e,e.sortedBy),i(e.order)}function v(e){var t=e.target,n=t.getAttribute("data-sort");if(n){var a=(0,k.getPlaylistById)((0,y.getVisiblePlaylistId)());if(this.removeEventListener("click",v),(0,g.removePresentPanels)(),n===a.sortedBy)return;r((0,p.capitalize)(n)),i(),l(a,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.resetPlaylistSort=t.changePlaylistOrder=t.sortTracks=t.createSortPanel=t.setSortOptions=void 0;var p=n(1),y=n(6),g=n(10),b=n(7),k=n(2),h=n(3),T=n(8);t.setSortOptions=s,t.createSortPanel=f,t.sortTracks=a,t.changePlaylistOrder=m,t.resetPlaylistSort=u},function(e,t){"use strict";function n(e,t){i[e]=t,localStorage.setItem("settings",JSON.stringify(i))}function r(e){return i[e]}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign({repeat:!1,shuffle:!1,once:!1,volume:.2},JSON.parse(localStorage.getItem("settings"))||{});t.setSetting=n,t.getSetting=r},function(e,t,n){"use strict";function r(e){return new Promise(function(t){var n=URL.createObjectURL(e),r=new Audio(n);r.preload="metadata",r.addEventListener("loadedmetadata",function e(){t(Math.floor(r.duration)),r.removeEventListener("loadedmetadata",e),r=null,n=URL.revokeObjectURL(n)})})}function i(e){return e.slice(0,e.lastIndexOf("."))}function a(e){var t=new Audio;return e.filter(function(e){return t.canPlayType(e.type)})}function o(e,t){return e.reduce(function(e,n){var r=i(n.name.trim()),a=t.some(function(e){return e.name===r});return a||e.push({audioTrack:n,name:r}),e},[])}function l(e){return new Promise(function(t){
parse_audio_metadata(e,function(e){t(e)})})}function s(e,t,n){return Promise.all([l(e[0].audioTrack),r(e[0].audioTrack)]).then(function(r){return t.push({index:n+t.length,title:r[0].artist?r[0].title.trim():e[0].name,artist:r[0].artist?r[0].artist.trim():"",album:r[0].album?r[0].album.trim():"",name:e[0].name,thumbnail:r[0].picture||"assets/images/album-art-placeholder.png",audioTrack:e[0].audioTrack,durationInSeconds:r[1],duration:(0,f.formatTime)(r[1]),player:"native"}),e=e.slice(1),e.length?s(e,t,n):t})}function c(e,t,n,r){return f.scriptLoader.load({src:"js/libs/metadata-audio-parser.min.js"}).then(function(){return n(t,[],e.tracks.length)}).then(function(t){(0,v.updatePlaylist)(e,t,r)}).catch(function(e){console.log(e)})}function u(e,t,n,r){var i=o(n,t.tracks);return(0,p.createImportOptionMask)(e),n.length?i.length?void c(t,i,r,e):void(0,p.showNotice)(e,"Tracks already exist"):void(0,p.showNotice)(e,"No valid audio files found")}function d(e){var t=a(e),n=(0,m.getPlaylistById)("local-files")||(0,m.createPlaylist)({id:"local-files",title:"Local files",type:"list",player:"native"});u("local",n,t,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.selectLocalFiles=t.addTracks=t.getTrackDuration=void 0;var f=n(1),m=n(2),v=n(3),p=n(5);t.getTrackDuration=r,t.addTracks=u,t.selectLocalFiles=d},function(e,t,n){"use strict";function r(e){B&&B.removeEventListener("mousedown",T),B=document.getElementById("js-"+e),B.addEventListener("mousedown",T)}function i(e){var t=document.createElement("li");return L.left=j.x,L.top=j.y,t.setAttribute("id","js-selected-area"),t.setAttribute("class","selected-area"),t.style.top=j.y+"px",t.style.left=j.x+"px",e.appendChild(t),t}function a(){(0,P.removeElement)(M),M=null}function o(e){var t=x,n=B.scrollTop;return Array.from(e).map(function(e){var r=e.getBoundingClientRect(),i=n+r.top-t.top,a=r.left-t.left,o=a+r.width,l=i+r.height;return{ref:e,top:i,right:o,bottom:l,left:a}})}function l(e,t,n){var r=e.x-t.x,i=e.y-t.y;if(r<0){var a=t.x+r;r*=-1,L.left=a,n.left=a+"px"}else L.left!==t.x&&(L.left=t.x,n.left=t.x+"px");if(i<0){var o=t.y+i;i*=-1,L.top=o,n.top=o+"px"}else L.top!==t.y&&(L.top=t.y,n.top=t.y+"px");L.right=L.left+r,L.bottom=L.top+i,n.width=r+"px",n.height=i+"px"}function s(e){e&&(V=!0,(0,I.showMoveToBtn)())}function c(e){!V&&(0,P.isOutsideElement)(e,"js-tab-header")&&((0,P.removeElementClass)("track","selected"),(0,I.hideMoveToBtn)()),V=!1}function u(e,t){var n=(0,P.getElementByAttr)(e,"data-index");n&&(t||(0,P.removeElementClass)("track","selected"),V=!0,n.elementRef.classList.toggle("selected"),s(n.elementRef.classList.contains("selected")))}function d(e,t,n){e.forEach(function(e){var r=e.ref.classList;t.right>e.left&&t.left<e.right&&t.bottom>e.top&&t.top<e.bottom?(n&&!e.selected&&r.contains("selected")&&(r.remove("selected"),e.removed=!0),e.removed||(r.add("selected"),e.selected=!0)):e.selected?(r.remove("selected"),e.selected=!1):e.removed&&(r.add("selected"),e.removed=!1)})}function f(e,t){return e>t?t:e<0?0:e}function m(e,t){return e.x>t.x+2||e.x<t.x-2&&e.y>t.y+2||e.y<t.y-2}function v(){clearInterval(O),O=0}function p(){requestAnimationFrame(a),C=!1,L={},A.length=0}function y(e){_=!0,requestAnimationFrame(function(){l(w,j,M.style),d(A,L,e),_=!1})}function g(e){B.scrollTop+=36,w.y=B.scrollTop+x.height,w.y>=S&&(w.y=S,v()),_||y(e)}function b(e){B.scrollTop-=36,w.y=B.scrollTop,w.y<=0&&(w.y=0,v()),_||y(e)}function k(e){var t=e.clientY-x.top;return w.x=f(e.clientX-x.left,x.width-10),w.y=f(B.scrollTop+t,S),e.preventDefault(),C?!O&&t>x.height&&w.y<S?void(O=setInterval(function(){g(e.ctrlKey)},40)):!O&&t<0&&w.y>0?void(O=setInterval(function(){b(e.ctrlKey)},40)):(_||y(e.ctrlKey),void(O&&t>0&&t<x.height&&v())):(C=m(w,j),void(C&&!M&&(A=o(B.children),M=i(B),e.ctrlKey||A.forEach(function(e){return e.ref.classList.remove("selected")}))))}function h(e){var t=e.target,n=e.ctrlKey;if(O&&v(),C){var r=(0,E.getSelectedTrackElements)();p(),s(r.length)}else u(t,n);window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",h)}function T(e){1===e.which&&(x=B.getBoundingClientRect(),j.x=e.clientX-x.left,j.y=B.scrollTop+e.clientY-x.top,S=B.scrollHeight,window.addEventListener("mousemove",k),window.addEventListener("mouseup",h))}Object.defineProperty(t,"__esModule",{value:!0}),t.deselectTrackElements=t.enableTrackSelection=void 0;var P=n(1),E=n(3),I=n(11),j={},w={},L={},B=null,x=null,A=[],S=0,M=null,C=!1,O=0,_=!1,V=!1;t.enableTrackSelection=r,t.deselectTrackElements=c},function(e,t,n){"use strict";function r(e){return u.some(function(t){return t===e})}function i(e){return window.location.hash.includes(e)}function a(e){r(e)||u.push(e)}function o(e){window.location.hash="/"+e}function l(e){if(!e)return void o("manage");if("404"!==e&&!r(e))return void o("404");var t=e.startsWith("playlist/"),n=t?e.split("playlist/")[1]:e;(0,c.toggleTab)(n,t,"404"===n)}function s(){var e=window.location.hash.slice(2);l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isActive=t.toggleCurrent=t.toggle=t.add=void 0;var c=n(6),u=["manage","404"];window.addEventListener("hashchange",function(e){var t=e.newURL.split("#/")[1];t?l(t):history.back()}),t.add=a,t.toggle=o,t.toggleCurrent=s,t.isActive=i},function(e,t,n){"use strict";function r(){return c?Promise.resolve():(c=!0,l.scriptLoader.load({src:"js/libs/sdk.min.js"}).then(function(){return SC.initialize({client_id:"7d6323d8ecbfb64acb9cf2e5f5ef150c"})}))}function i(e){return e.map(function(e,t){var n=Math.floor(e.duration/1e3);return{index:t,durationInSeconds:n,duration:(0,l.formatTime)(n),id:e.id,name:e.title,title:e.title,artist:"",album:"",thumbnail:e.artwork_url||"assets/images/album-art-placeholder.png",player:"soundcloud"}})}function a(e,t){return{url:t,id:e.id?e.id.toString():e[0].user_id.toString(),title:e.title||e[0].user.username,tracks:i(e.tracks?e.tracks:e),player:"soundcloud",type:"grid"}}function o(e){r().then(function(){return SC.resolve(e)}).then(function(t){return a(t,e)}).then(s.addImportedPlaylist).catch(function(e){console.log(e),404===e.status&&(0,s.showNotice)("soundcloud","Playlist was not found")})}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchPlaylist=t.initSoundCloud=void 0;var l=n(1),s=n(5),c=!1;t.initSoundCloud=r,t.fetchPlaylist=o},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){var t=document.getElementById("js-play-btn");e?t.classList.remove("icon-pause"):t.classList.add("icon-pause"),t.setAttribute("title",e?"Play":"Pause")}function a(e,t){var n=document.getElementById("js-"+e+"-bar"),r=n.getBoundingClientRect(),i=r.left,a=r.width,o=(t-i)/a;return o<0?o=0:o>1&&(o=1),100*o}function o(e){return a("track",e)}function l(){I.stop(),m(),d()}function s(e){var t=a("volume",e.pageX),n=t/100,r=(0,h.getCurrentTrack)();f(t),(0,b.setSetting)("volume",n),r&&P.setVolume(r,n)}function c(){document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",c)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;document.getElementById("js-"+e+"-bar-inner").style.width=t+"%"}function d(e){u("track",e)}function f(e){u("volume",e)}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;document.getElementById("js-track-current").textContent=(0,k.formatTime)(e)}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0:00";document.getElementById("js-track-duration").textContent=e}function p(e){var t=e.pageX;d(o(t))}function y(e){var t=e.pageX,n=(0,h.getCurrentTrack)();n&&P.seekTo(n,o(t)),E=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",y)}function g(e){var t=(0,b.getSetting)(e);t&&document.querySelector('[data-control-item="'+e+'"]').classList.add("active")}Object.defineProperty(t,"__esModule",{value:!0}),t.resetTrackBar=t.showTrackDuration=t.displayCurrentTime=t.setTrackBarInnerWidth=t.togglePlayBtn=t.elapsedTime=void 0;var b=n(13),k=n(1),h=n(2),T=n(4),P=r(T),E=!1,I=function(){function e(){r&&clearTimeout(r)}function t(e,n,i){var a=performance.now()-n,o=a-i;if(m(e.currentTime),!E){var l=e.currentTime/e.duration*100;d(l),P.storedTrack.updateSavedTrack({elapsed:l,currentTime:e.currentTime})}r=setTimeout(function(){e.currentTime<e.duration?(e.currentTime+=1,i+=1e3,t(e,n,i)):(P.storedTrack.updateSavedTrack({elapsed:0,currentTime:0}),(0,k.dispatchEvent)("track-end"))},1e3-o)}function n(n){var r=performance.now();e(),t(n,r,0)}var r=0;return{stop:e,start:n}}();document.getElementById("js-track-bar").addEventListener("mousedown",function(e){1===e.which&&(0,h.getCurrentTrack)()&&(E=!0,p(e),document.addEventListener("mousemove",p),document.addEventListener("mouseup",y))}),document.getElementById("js-volume-bar").addEventListener("mousedown",function(e){1===e.which&&(s(e),document.addEventListener("mousemove",s),document.addEventListener("mouseup",c))}),document.getElementById("js-controls").addEventListener("click",function(e){var t=e.target,n=t.getAttribute("data-control-item");if("repeat"===n||"shuffle"===n||"once"===n)return t.classList.toggle("active"),(0,b.setSetting)(n,!(0,b.getSetting)(n)),void("shuffle"===n&&P.toggleShuffle(!(0,b.getSetting)(n)));switch(n){case"previous":P.playPreviousTrack();break;case"play":P.playTrack();break;case"stop":P.stopPlayer(),P.storedTrack.remove();break;case"next":P.playNextTrack()}}),window.addEventListener("DOMContentLoaded",function e(){var t=(0,b.getSetting)("volume");g("repeat"),g("shuffle"),g("once"),f(100*t),window.removeEventListener("DOMContentLoaded",e)}),t.elapsedTime=I,t.togglePlayBtn=i,t.setTrackBarInnerWidth=d,t.displayCurrentTime=m,t.showTrackDuration=v,t.resetTrackBar=l},function(e,t,n){"use strict";function r(e,t,n){return e.audioBlobURL=URL.createObjectURL(e.audioTrack),e.audio=new Audio(e.audioBlobURL),o(t,e),(0,s.setCurrentTrack)(e),e.audio.onplaying=function(){(0,c.onTrackStart)(Math.floor(e.audio.currentTime))},"number"==typeof n?void l(n,e):void e.audio.play()}function i(e){var t=e.audio;return{play:t.play.bind(t),pause:t.pause.bind(t)}}function a(e){URL.revokeObjectURL(e.audioBlobURL),e.audio.load(),e.audio.onplaying=null,delete e.audioBlobURL,delete e.audio}function o(e,t){t.audio.volume=e}function l(e,t){t.audio.currentTime=e}Object.defineProperty(t,"__esModule",{value:!0}),t.setVolume=t.seekTo=t.getPlayPauseCallbacks=t.stopTrack=t.playTrack=void 0;var s=n(2),c=n(4);t.playTrack=r,t.stopTrack=a,t.getPlayPauseCallbacks=i,t.seekTo=l,t.setVolume=o},function(e,t,n){"use strict";function r(e,t,n){(0,c.setCurrentTrack)(e),(0,s.initSoundCloud)().then(function(){return SC.stream("/tracks/"+e.id)}).then(function(e){d&&d.dispose(),d=e,d.on("play-resume",function(){(0,u.onTrackStart)(Math.floor(d.currentTime()/1e3))}),"number"==typeof n&&d.once("state-change",function(e){"loading"===e&&(l(n),d.pause())}),o(t),d.seek(0),d.play()}).catch(function(e){console.log(e)})}function i(){return{play:d.play.bind(d),pause:d.pause.bind(d)}}function a(){d.seek(0),d.pause()}function o(e){d.setVolume(e)}function l(e){d.seek(1e3*e)}Object.defineProperty(t,"__esModule",{value:!0}),t.setVolume=t.seekTo=t.getPlayPauseCallbacks=t.stopTrack=t.playTrack=void 0;var s=n(17),c=n(2),u=n(4),d=null;t.playTrack=r,t.stopTrack=a,t.getPlayPauseCallbacks=i,t.seekTo=l,t.setVolume=o},function(e,t,n){"use strict";function r(e){var t=e.data;if(t===YT.PlayerState.PLAYING){if(p)return v.pauseVideo(),void(p=!1);(0,m.onTrackStart)(Math.floor(v.getCurrentTime()))}}function i(){m.storedTrack.setPlayerAsReady("youtube")}function a(e){console.log(e)}function o(){v=new YT.Player("yt-player",{height:"390",width:"640",videoId:"",events:{onReady:i,onStateChange:r,onError:a}})}function l(){return{play:v.playVideo.bind(v),pause:v.pauseVideo.bind(v)}}function s(e,t,n){u(t),(0,f.setCurrentTrack)(e),"number"==typeof n?(p=!0,v.loadVideoById(e.id,n)):v.loadVideoById(e.id)}function c(){v.stopVideo()}function u(e){v.setVolume(100*e)}function d(e){v.seekTo(e,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.setVolume=t.seekTo=t.getPlayPauseCallbacks=t.stopTrack=t.playTrack=void 0;var f=n(2),m=n(4),v=null,p=!1;window.onYouTubeIframeAPIReady=o,t.playTrack=s,t.stopTrack=c,t.getPlayPauseCallbacks=l,t.seekTo=d,t.setVolume=u},function(e,t,n){"use strict";function r(e){var t=document.createElement("div"),n=document.createElement("h3"),r=document.createElement("ul");return t.classList.add("pl-entry-container"),n.classList.add("manage-tab-section-title"),r.classList.add("pl-entries"),n.textContent="Playlist entries",r.id=e,r.addEventListener("click",u),t.appendChild(n),t.appendChild(r),document.getElementById("js-manage-tab-content").appendChild(t),r}function i(e){e.removeEventListener("click",u),(0,d.removeElement)(e.parentElement)}function a(){var e="js-pl-entries";return document.getElementById(e)||r(e)}function o(e,t,n){var r=a(),i='\n        <li class="pl-entry" data-id='+t+'>\n            <form class="pl-entry-form">\n                <input type="text" class="input pl-entry-title" value="'+e+'" readonly>\n                <button type="submit" class="icon-pencil btn btn-transparent"\n                    data-action="edit" title="Edit"></button>\n            </form>\n            <button type="submit" class="icon-cw btn btn-transparent '+(n?"":"hidden")+'"\n                data-action="refresh" title="Refresh"></button>\n            <button class="icon-trash btn btn-transparent"\n                data-action="remove" title="Remove playlist"></button>\n        </li>\n    ';r.insertAdjacentHTML("beforeend",i)}function l(e){var t=e.parentElement;(0,d.removeElement)(e),t.children.length||i(t)}function s(e,t){var n="edit"===t?"save":"edit";e.setAttribute("title",(0,d.capitalize)(n)),e.setAttribute("data-action",n),e.classList.toggle("active")}function c(e,t,n){var r=t.querySelector(".pl-entry-title");if("edit"===e)r.removeAttribute("readonly"),r.focus(),r.selectionStart=0,r.selectionEnd=r.value.length;else if("save"===e){var i=(0,v.getPlaylistById)(n);r.value||(r.value=i.title);var a=r.value;a!==i.title&&(i.title=a,(0,m.editSidebarEntry)(n,a),r.setAttribute("value",a),(0,f.postMessageToWorker)({action:"update",playlist:{id:i.id,title:i.title}})),r.setAttribute("readonly","readonly")}}function u(e){var t=(0,d.getElementByAttr)(e.target,"data-id"),n=e.target.getAttribute("data-action");if(e.preventDefault(),t&&n){if("remove"===n)return(0,p.removePlaylist)(t.attrValue),void l(t.elementRef);if("refresh"===n){var r=(0,v.getPlaylistById)(t.attrValue),i=r.url,a="";return i.includes("youtube")?a="youtube":i.includes("soundcloud")&&(a="soundcloud"),(0,y.createImportOptionMask)(a),(0,y.importPlaylist)(i),void e.target.classList.add("hidden")}c(n,t.elementRef,t.attrValue),s(e.target,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.createPlaylistEntry=void 0;var d=n(1),f=n(7),m=n(9),v=n(2),p=n(3),y=n(5);t.createPlaylistEntry=o},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){return e.tracks=e.tracks.map(function(e,t){return{index:t,id:e.snippet.resourceId.videoId,durationInSeconds:e.durationInSeconds,duration:(0,f.formatTime)(e.durationInSeconds),name:e.snippet.title,title:e.snippet.title,artist:"",album:"",thumbnail:e.snippet.thumbnails.default.url,player:"youtube"}}),delete e.token,e}function a(e){if(e=e.slice(2),e.includes("H")||(e="0H"+e),!e.includes("M")){var t=e.indexOf("H")+1;e=e.slice(0,t)+"0M"+e.slice(t)}return e=e.includes("S")?e.slice(0,-1):e+"0",e.replace(/[HM]/g,":").split(":").reverse().reduce(function(e,t,n){return e+=t*Math.pow(60,n)},0)}function o(e){return e.id=e.items.map(function(e){return e.snippet.resourceId.videoId}).join(),l("videos","contentDetails","id",e).then(function(t){return e.items=e.items.map(function(e,n){return e.durationInSeconds=a(t.items[n].contentDetails.duration),e}),e})}function l(e,t,n,r){var i="AIzaSyD33Rxm4dA34Mh84oSxYTUUF_jyCLLOua4",a="part="+t+"&"+n+"="+r.id+"&maxResults=50&key="+i;return r.token&&(a+="&pageToken="+r.token),fetch("https://www.googleapis.com/youtube/v3/"+e+"?"+a).then(function(e){return e.json()})}function s(e){return e.items=e.items.filter(function(e){var t=e.snippet.title;return"Deleted video"!==t&&"Private video"!==t}),e}function c(e){return l("playlistItems","snippet","playlistId",e).then(s).then(o).then(function(t){var n;return e.token=t.nextPageToken,(n=e.tracks).push.apply(n,r(t.items)),e.token?c(e):e})}function u(e){return l("playlists","snippet","id",e).then(function(t){return t.items.length?(e.title=t.items[0].snippet.title,e):void(0,m.showNotice)("youtube","Playlist was not found")})}function d(e){if(!e.includes("list="))return void(0,m.showNotice)("youtube","Invalid url");var t={url:e,id:e.split("list=")[1],tracks:[],player:"youtube",type:"grid"};u(t).then(c).then(i).then(m.addImportedPlaylist).then(function(){f.scriptLoader.load({src:"https://www.youtube.com/iframe_api"})}).catch(function(e){console.log(e)})}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchPlaylist=void 0;var f=n(1),m=n(5);t.fetchPlaylist=d},function(e,t,n){"use strict";function r(e){return fetch(e).then(function(e){return e.blob()})}function i(e,t,n){var a={index:n+t.length,title:e[0].name,artist:"",album:"",name:e[0].name,thumbnail:"assets/images/album-art-placeholder.png",player:"native"};return r(e[0].audioTrack.link).then(function(e){return a.audioTrack=e,(0,l.getTrackDuration)(e)}).then(function(r){return a.durationInSeconds=r,a.duration=(0,o.formatTime)(r),t.push(a),e=e.slice(1),e.length?i(e,t,n):t})}function a(){Dropbox.choose({success:function(e){var t=(0,s.getPlaylistById)("dropbox-tracks")||(0,s.createPlaylist)({id:"dropbox-tracks",title:"Dropbox tracks",type:"grid",player:"native"});(0,c.setOption)(),(0,l.addTracks)("dropbox",t,e,i)},cancel:function(){(0,c.setOption)()},linkType:"direct",multiselect:!0,extensions:["audio"]})}Object.defineProperty(t,"__esModule",{value:!0}),t.showDropboxChooser=void 0;var o=n(1),l=n(14),s=n(2),c=n(5);t.showDropboxChooser=a}]);