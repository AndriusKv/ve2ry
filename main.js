!function(t){function e(e){for(var i,r,a=e[0],c=e[1],l=e[2],u=0,m=[];u<a.length;u++)r=a[u],o[r]&&m.push(o[r][0]),o[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);for(d&&d(e);m.length;)m.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(i=!1)}i&&(s.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},o={0:0},s=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var a=window.webpackJsonp=window.webpackJsonp||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var d=c;s.push([117,1]),n()}({117:function(t,e,n){"use strict";n.r(e);n(82),n(83),n(84),n(85),n(15),n(6),n(17);const i=function(){const t=[];return{load:function(e){return t.includes(e.src)?Promise.resolve():new Promise(n=>{const i=document.createElement("script");Object.keys(e).forEach(t=>{i.setAttribute(t,e[t])}),document.getElementsByTagName("body")[0].appendChild(i),t.push(e.src),i.onload=n})}}}();function o(t){t.parentElement.removeChild(t)}function s(t,e){const n=document.querySelector(t);n&&n.classList.remove(e)}function r(t,e,n=null){for(;e&&e!==n;){if(e.hasAttribute(t))return{elementRef:e,attrValue:e.getAttribute(t)};e=e.parentElement}}function a(t,e){return!!e&&!e.contains(t)}function c(t,e=!0){return e&&t<10?"0"+t:t}function l(t,e=!1){const n=function(t){return Math.floor(t/3600)}(t),i=function(t){return Math.floor(t/60%60)}(t),o=function(t){return t%60}(t);return((e=e||n)?n+":":"")+c(i,e)+":"+c(o)}function d(t,e){const n=new CustomEvent(t,{detail:e});window.dispatchEvent(n)}function u(t){return"object"==typeof t?URL.createObjectURL(t):t}function m(t,{id:e,title:n}){t.setAttribute("title",n),t.querySelector("use").setAttribute("href","#"+e)}function f(t){let e=t.length;for(;e;){const n=Math.floor(Math.random()*e);e-=1,[t[e],t[n]]=[t[n],t[e]]}return t}function p(t){return'\n        <svg viewBox="0 0 24 24" '+(t.elementId?"id="+t.elementId:"")+" "+(t.className?'class="'+t.className+'"':"")+">\n            "+(t.title?"<title>"+t.title+"</title>":"")+'\n            <use href="#'+t.iconId+'"></use>\n        </svg>\n    '}const g=Object.assign({repeat:!1,shuffle:!1,once:!1,mute:!1,volume:.4},JSON.parse(localStorage.getItem("settings"))||{});function y(t,e){g[t]=e,h(g)}function v(t){return g[t]}function b(t){delete g[t],h(g)}function h(t){localStorage.setItem("settings",JSON.stringify(t))}n(29),n(111),n(77),n(78);let w=[];function k(t){return w.some(e=>e===t)}function E(){const t=window.location.hash.slice(2).replace(/\/+$/g,"");let e=!1,n="home";d("route-change",{tabId:n=t&&!k(t)?"not-found":(e=t.startsWith("playlist/"))?t.split("playlist/")[1]:n,isPlaylistTab:e})}window.addEventListener("hashchange",E);const I={},L={};let j="",x=null,T=-1,B=[];function A(t){return I[t]}function S(t){return L[t.id]={sortOrder:[]},I[t.id]=Object.assign({sortedBy:"index",order:1,tracks:[]},t),I[t.id]}function O(t,e){Object.assign(I[t],e)}function M(t){return L[t]}function R(t,e){Object.assign(L[t],e)}function P(t){return t.reduce((t,e)=>t+=e.durationInSeconds,0)}function H(t=""){j=t}function C(){return j}function _(t){return t===j}function V(t){return t?Object.assign({},t):null}function U(t){x=t}function q(){return x}function D(t){const e=q();if(e&&_(t)){const i=W(t,e.name),o=i?i.index:-1;n={index:o},Object.assign(x,n),N(t,o)}var n}function W(t,e){const n=I[t];return n?n.tracks.find(t=>t.name===e):null}function N(t,e){const{sortOrder:n}=L[t],i=n.indexOf(e);T=(T=B.indexOf(i))<0?0:T}function z(t,e){const n=q(),{tracks:i}=I[t];L[t].shuffled=e,B=function(t,e){const n=t.map(({index:t})=>t);return e?f(n):n}(i,e),n&&N(t,n.index)}function X(t,e){const n=function(t){let e=T;return e+=t,!t||e>=B.length?e=0:-1===e&&(e=B.length-1),B[e]}(e),{tracks:i}=I[t],{sortOrder:o}=L[t];return V(i[o[n]])}function Y(t){t.tracks=t.tracks.map((t,e)=>(t.index=e,t))}function J(t,e){return"index"===t?e.index:"duration"===t?e.durationInSeconds:e[t].toLowerCase()}function K(t){var e,n,i;L[t.id].sortOrder=(e=t.tracks,n=t.sortedBy,i=t.order,[...e].sort((t,e)=>{const o=J(n,t),s=J(n,e);return o<s?-i:o>s?i:0}).map(({index:t})=>t))}n(79);let F=null;function Z(){window.removeEventListener("click",Q,!0),o(F.element),F=null}function $(t,e,n){e(t,n),F={id:t,element:document.getElementById(t),removeOnClick:n.removeOnClick,initiator:n.element},window.addEventListener("click",Q,!0)}function G(t,e,n){if(F){const i=F.id;Z(),i!==t&&$(t,e,n)}else $(t,e,n)}function Q({target:t}){if(F.removeOnClick)return void Z();const e=a(t,F.element),n=a(t,F.initiator);e&&n&&Z()}function tt(t){return document.getElementById("js-sidebar-entry-"+t)}function et(){const t=document.getElementById("js-active-playlist-icon");t&&o(t)}function nt(t,{element:e}){e.insertAdjacentHTML("afterend",'\n        <div id="'+t+'" class="panel sidebar-form-panel"></div>\n    '),no("sidebar",document.getElementById(t),"beforeend",it)}function it(t){eo(t),Z()}document.getElementById("js-sidebar-container").addEventListener("click",({currentTarget:t,target:e})=>{if(r("data-link",e,t)||a(e,t.firstElementChild))return void t.classList.add("hidden");const n=r("data-btn",e,t);n&&G("js-sidebar-form-panel",nt,{element:n.elementRef})}),window.addEventListener("connectivity-status",({detail:t})=>{document.getElementById("js-online-status").classList.toggle("visible",!t)});const ot=document.getElementById("js-google-sign-in");let st=null,rt=!1,at=!1;function ct(){return rt}async function lt(t){if(!t.disabled){t.disabled=!0;try{if(!rt)return void await dt(!0);const e=gapi.auth2.getAuthInstance();e.isSignedIn.get()?(await e.signOut(),st=null,document.getElementById("js-google-panel-toggle-btn").remove(),ot.insertAdjacentHTML("beforeend",'\n        <button id="js-google-sign-in-btn" class="btn-icon google-sign-in-btn"\n            data-item="google-sign-in">Sign In</button>\n    '),Z()):(await e.signIn(),ut(t,e))}catch(e){t.disabled=!1,console.log(e)}}}async function dt(t=!1){if(rt||at)return;const e=document.getElementById("js-google-sign-in-btn");at=!0,e.disabled=!0;try{await i.load({src:"https://apis.google.com/js/api.js"}),await new Promise(t=>gapi.load("client:auth2",t)),await gapi.client.init({apiKey:"AIzaSyD33Rxm4dA34Mh84oSxYTUUF_jyCLLOua4",clientId:"293076144560-r5cear7rprgo094u6ibcd6nl3bbg18te.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest"],scope:"https://www.googleapis.com/auth/youtube.force-ssl"});const n=gapi.auth2.getAuthInstance();n.isSignedIn.get()?ut(e,n):t&&(await n.signIn(),ut(e,n)),rt=!0,at=!1,d("google-api-initialized")}catch(t){at=!1,e.disabled=!1,console.log(t)}}function ut(t,e){!function(t){const e=t.currentUser.get().getBasicProfile();st={name:e.getName(),email:e.getEmail(),image:e.getImageUrl()}}(e),t.remove(),ot.insertAdjacentHTML("afterbegin",'\n        <button id="js-google-panel-toggle-btn" class="btn-icon google-panel-toggle-btn">\n            <img src="'+st.image+'" class="google-user-image" alt="">\n        </button>\n    '),document.getElementById("js-google-panel-toggle-btn").addEventListener("click",ft)}function mt(t,{element:e}){e.insertAdjacentHTML("afterend","\n        <div id="+t+' class="panel google-panel">\n            <div class="google-user">\n                <img src="'+st.image+'" class="google-user-image" alt="">\n                <div class="google-user-details">\n                    <div class="google-user-name">'+st.name+"</div>\n                    <div>"+st.email+'</div>\n                </div>\n            </div>\n            <button id="js-google-sign-in-btn"\n                class="btn-icon google-sign-in-btn"\n                data-item="google-sign-in">Sign Out</button>\n        </div>\n    ')}function ft({currentTarget:t}){G("js-google-panel",mt,{element:t})}n(80);var pt=n(30);function gt(){return document.getElementById("js-player-messages")||function(){const t=document.createElement("div");return t.id="js-player-messages",t.classList.add("player-messages"),document.getElementById("js-player").appendChild(t),t}()}function yt(){const t=gt();o(t.lastElementChild),t.childElementCount||o(t)}function vt({title:t,body:e}){gt().insertAdjacentHTML("afterBegin",'\n        <div class="player-message">\n            <h3 class="player-message-title">'+t+'</h3>\n            <p class="player-message-body">'+e+"</p>\n        </div>\n    "),setTimeout(yt,6e3)}function bt(){location.reload()}function ht(){d("connectivity-status",navigator.onLine)}async function wt(t,e,n=[]){const i=n.length,{audioTrack:o,name:s}=t[i];var r,a,c;r="Processing: "+s,a=i+1,c=t.length,function(t=""){document.getElementById("js-import-progress-label").textContent=t}(r),document.getElementById("js-import-progress-bar-inner").style.transform="scaleX("+a/c+")",document.getElementById("js-import-progress-bar-label").textContent=a+"/"+c;let{artist:d,title:u,album:m,duration:f,picture:p}=await Object(pt.a)(o);return navigator.onLine&&d&&u&&({album:m,picture:p}=await async function(t,e,n,i){if(n&&i)return{album:n,picture:i};try{const o="https://ws.audioscrobbler.com/2.0/",s="?method=track.getInfo&api_key=3e8d48b3277c21bc77965345f5faf18c&artist="+t+"&track="+e+"&format=json",r=await fetch(o+s).then(t=>t.json());if(r.track&&r.track.album){const{title:t,image:e}=r.track.album;if(!n&&t&&(n=t),!i&&e){const t=e[e.length-1]["#text"];if(t){const{origin:e,pathname:n}=new URL(t),[o]=n.split("/").slice(-1);i=e+"/i/u/"+o}}}}catch(t){console.log(t)}return{album:n,picture:i}}(d,u,m,p)),n.push({audioTrack:o,name:s,title:d?u:s,artist:d||"",album:m||"",thumbnail:p||"assets/images/album-art-placeholder.png",durationInSeconds:f,duration:l(f),player:"native",playlistId:e}),i+1===t.length?n:wt(t,e,n)}async function kt(t,e,n,i){if(!n.length)return void vt({title:t+" files",body:"No valid audio file found"});const o=(s=n,r=e.tracks,s.reduce((t,e)=>{const n=function(t){return t.slice(0,t.lastIndexOf("."))}(e.name.trim());return r.some(t=>t.name===n)||t.push({audioTrack:e,name:n}),t},[]));var s,r;if(o.length){d("import",{importing:!0,option:t,playlistId:e.id});try{to(e,await i(o,e.id))}catch(t){console.log(t)}finally{d("import",{importing:!1,option:t,playlistId:e.id})}}else vt({title:t+" files",body:"Track"+(n.length>1?"s":"")+" already exist"})}function Et(t){const e=function(t){const e=new Audio,n=[];return t=t.reduce((t,i)=>{if(e.canPlayType(i.type))t.push(i);else{const{name:t}=i;n.push(t.slice(t.lastIndexOf(".")))}return t},[]),n.length&&vt({title:"Local files",body:"Can't play audio files with type: "+n.join(", ")}),t}(t),n="local-files";kt("local",A(n)||S({id:n,title:"Local files",type:"list",storePlaylist:qt.getSetting(n,"storePlaylist")}),e,wt)}async function It(t,e,n=[]){const i=t[n.length],o=await(s=i.audioTrack.link,fetch(s).then(t=>t.blob()));var s;const{duration:r}=await Object(pt.a)(o);return n.push({audioTrack:o,durationInSeconds:r,title:i.name,artist:"",album:"",name:i.name,duration:l(r),thumbnail:"assets/images/album-art-placeholder.png",player:"native",playlistId:e}),n.length===t.length?n:It(t,e,n)}window.addEventListener("sw-state-change",({detail:t})=>{"update"===t&&(gt().insertAdjacentHTML("afterBegin",'\n        <div class="player-message service-worker-message">\n            <p class="player-message-body">Update is available, please refresh.</p>\n            <button id="js-player-message-btn" class="btn-icon player-message-btn">Refresh</button>\n        </div>\n    '),document.getElementById("js-player-message-btn").addEventListener("click",bt),setTimeout(yt,6e3))}),window.addEventListener("online",ht),window.addEventListener("offline",ht),window.addEventListener("load",ht),document.getElementById("js-dropbox-option").addEventListener("mouseenter",function t({currentTarget:e}){i.load({src:"https://www.dropbox.com/static/api/2/dropins.js",id:"dropboxjs","data-app-key":"6ur73hspbv8o1z9"}),e.removeEventListener("mouseenter",t)});n(114);const Lt=[];let jt=null;function xt(t){vt({title:"YouTube",body:t})}function Tt(t){if(t.includes("H")||(t="0H"+t),!t.includes("M")){const e=t.indexOf("H")+1;t=t.slice(0,e)+"0M"+t.slice(e)}return t.includes("S")||(t+="0"),t.match(/\d{1,}/g).reverse().reduce((t,e,n)=>t+=e*60**n,0)}function Bt(t,e,n,i,o){let s="part="+e+"&"+n+"="+i+"&maxResults=50&key=AIzaSyD33Rxm4dA34Mh84oSxYTUUF_jyCLLOua4";return o&&(s+="&pageToken="+o),jt&&(s+="&access_token="+jt),fetch("https://www.googleapis.com/youtube/v3/"+t+"?"+s).then(t=>t.json())}function At(t,e){return t.reduce((t,n)=>{return e.some(t=>t.id===n.id)||t.push(n),t},[])}function St(t){return t.filter(t=>{const e=t.snippet.title;return"Deleted video"!==e&&"Private video"!==e})}function Ot(t,e){return t.map(t=>({id:t.snippet.resourceId.videoId,durationInSeconds:t.durationInSeconds,duration:l(t.durationInSeconds),name:t.snippet.title,title:t.snippet.title,artist:"",album:"",thumbnail:t.snippet.thumbnails.medium.url,player:"youtube",playlistId:e}))}async function Mt(t,e){const{error:n,items:i,nextPageToken:o}=await Bt("playlistItems","snippet","playlistId",t,e);n&&function({code:t,message:e}){throw 403===t?e="You need to be sign in if you want to import private playlists":404===t&&(e="Playlist was not found"),xt(e),new Error(e)}(n);const s=Ot(await async function(t){const e=t.map(t=>t.snippet.resourceId.videoId).join(),n=await Bt("videos","contentDetails","id",e);return t.reduce((t,e)=>{const i=n.items.find(({id:t})=>t===e.snippet.resourceId.videoId);return i&&(e.durationInSeconds=Tt(i.contentDetails.duration)-1,t.push(e)),t},[])}(St(i)),t);if(o){const e=await Mt(t,o);return s.concat(e)}return s}async function Rt(t){const{items:e}=await Bt("playlists","snippet,status","id",t),n="private"===e[0].status.privacyStatus,i={title:e[0].snippet.title,isPrivate:n};return n&&(i.user=st),i}function Pt(t,e){return A(t)||S(Object.assign({id:t,type:"grid",storePlaylist:!0},e))}async function Ht(t,e){const n=Pt(t,{title:"YouTube"}),{items:i}=await Bt("videos","snippet,contentDetails","id",e);if(i.length){to(n,At(Ot(St(i).map(t=>(t.snippet.resourceId={videoId:t.id},t.durationInSeconds=Tt(t.contentDetails.duration)-1,t)),"youtube"),n.tracks))}else xt("Video was not found")}async function Ct(t,e,n){const i=Pt(e,{url:t}),o=await Mt(e);"sync"===n&&function({id:t,_id:e,tracks:n}){const{rendered:i}=M(t),o=qi(t);i&&o&&(o.innerHTML="");oo({action:"remove-tracks",playlist:{_id:e,tracks:n}}),n.length=0}(i),i.title||O(i.id,await Rt(e)),to(i,At(o,i.tracks))}async function _t(t,e){if(at)return void function(t,e){Lt.some(e=>e.url===t)||Lt.push({url:t,type:e})}(t,e);ct()&&function(){const t=gapi.auth2.getAuthInstance();jt=t.isSignedIn.get()?t.currentUser.get().getAuthResponse().access_token:null}();const{videoId:n,playlistId:i}=function(t){let e="",n="";try{const{searchParams:i}=new URL(t);e=i.get("v"),n=i.get("list")}catch(i){const o=t.match(/v=[a-zA-Z0-9\-_]+/),s=t.match(/list=[a-zA-Z0-9\-_]+/);o&&(e=o[0].slice(2)),s&&(n=s[0].slice(5))}return{videoId:e,playlistId:n}}(t),o=i||"youtube";if(n||i)if("WL"!==i){d("import",{importing:!0,option:"youtube",playlistId:o});try{n?await Ht(o,n):await Ct(t,o,e)}catch(t){console.log(t)}finally{d("import",{importing:!1,option:"youtube",playlistId:o})}}else xt("Importing Watch Later playlist is not allowed");else xt("Invalid url")}window.addEventListener("google-api-initialized",()=>{Lt.forEach(({url:t,type:e})=>{_t(t,e)}),Lt.length=0});const Vt=document.getElementById("js-import-options");let Ut="";const qt=function(){const t=Object.assign({},{"local-files":{storePlaylist:!1},dropbox:{storePlaylist:!1}},JSON.parse(localStorage.getItem("import-settings")));return{setSetting:function(e,n,i){t[e][n]=i,localStorage.setItem("import-settings",JSON.stringify(t))},getSetting:function(e,n){return t[e]?t[e][n]:null},getSettings:function(){return t}}}();function Dt(t=""){Ut=t}function Wt(){Dt(),function(){const t=document.getElementById("js-import-form");t&&(t.removeEventListener("submit",Jt),o(t),s(".import-option-btn.active","active"))}()}function Nt(t,e){const n=tt(t),i=function(t){const e=document.querySelector('[data-entry-id="'+t+'"]');if(e)return e.querySelector("[data-action='sync']");return null}(t);n&&n.classList.toggle("show-spinner",e),i&&(i.disabled=e)}function zt(t,{url:e,type:n}){"youtube"===t&&_t(e,n)}function Xt({target:t}){Et([...t.files]),t.value="",t.removeEventListener("change",Xt),o(t)}function Yt(t){const e=document.getElementById("js-file-picker")||function(){const t=document.createElement("input");return t.setAttribute("type","file"),t.setAttribute("id","js-file-picker"),t.setAttribute("accept","audio/*"),t.classList.add("file-picker"),t.addEventListener("change",Xt),document.body.appendChild(t),t}();"file"===t?(e.removeAttribute("webkitdirectory"),e.removeAttribute("directory"),e.removeAttribute("allowdirs"),e.setAttribute("multiple","")):"folder"===t&&(e.removeAttribute("multiple"),e.setAttribute("webkitdirectory",""),e.setAttribute("directory",""),e.setAttribute("allowdirs","")),e.click()}function Jt(t){const e=t.target.elements.url.value.trim();if(e){const n=t.target.getAttribute("data-for");Wt(),zt(n,{url:e})}t.preventDefault()}function Kt(t,{element:e}){e.insertAdjacentHTML("afterend",'\n        <div id="'+t+'" class="panel info-panel">\n            <h3 class="panel-title">Accepted formats</h3>\n            <ul>\n                <li class="info-panel-content-item">youtube.com/playlist?list={playlistId}</li>\n                <li class="info-panel-content-item">youtube.com/watch?v={videoId}</li>\n            </ul>\n        </div>\n    ')}function Ft(t,{element:e}){const n=qt.getSettings();e.insertAdjacentHTML("afterend",'\n        <div id="'+t+'" class="panel import-settings-panel">\n            <h3 class="panel-title">Settings</h3>\n            <label class="import-setting">\n                <input type="checkbox" class="checkbox-input"\n                    '+(n["local-files"].storePlaylist?"checked":"")+' data-id="local-files">\n                <div class="checkbox">\n                    <div class="checkbox-tick"></div>\n                </div>\n                <span class="import-setting-label">Store <b>Local files</b> playlist</span>\n            </label>\n            <label class="import-setting">\n                <input type="checkbox" class="checkbox-input"\n                    '+(n.dropbox.storePlaylist?"checked":"")+' data-id="dropbox">\n                <div class="checkbox">\n                    <div class="checkbox-tick"></div>\n                </div>\n                <span class="import-setting-label">Store <b>Dropbox</b> playlist</span>\n            </label>\n            <div class="import-setting-message">\n                <svg viewBox="0 0 24 24">\n                    <use href="#info"></use>\n                </svg>\n                <span>Stored playlists will persist through reload</span>\n            </div>\n        </div>\n    '),document.getElementById(t).addEventListener("change",Zt)}function Zt({target:t}){const e=t.getAttribute("data-id");qt.setSetting(e,"storePlaylist",t.checked)}function $t({attrValue:t,elementRef:e}){if("form-toggle"===t){const t="youtube";!function(t){return Ut!==t}(t)?Wt():(e.classList.add("active"),function(t,e){const n="js-import-form";t.insertAdjacentHTML("beforeend","\n        <form id="+n+' class="import-form" data-for="'+e+'">\n            <div class="import-form-input-container">\n                <input type="text" name="url" class="input import-form-input" placeholder="URL" required>\n                <button type="button"\n                    class="btn-icon import-info-btn" data-item="youtube-info">\n                    <svg viewBox="0 0 24 24">\n                        <use href="#info"></use>\n                    </svg>\n                </button>\n            </div>\n            <button class="btn">Import</button>\n        </form>\n    '),document.getElementById(n).addEventListener("submit",Jt)}(e.parentElement,t),Dt(t),ct()||dt())}else"google-sign-in"===t?lt(e):"youtube-info"===t&&G("js-"+t+"-panel",Kt,{element:e})}function Gt(){const t="js-pl-entries";return document.getElementById(t)||function(t){document.getElementById("js-tab-home").insertAdjacentHTML("beforeend",'\n        <div class="home-tab-section pl-entry-container">\n            <div class="home-tab-section-header">\n                <h2 class="home-tab-section-title">Playlists</h2>\n            </div>\n            <ul id="'+t+'"></ul>\n        </div>\n    ');const e=document.getElementById(t);return e.addEventListener("click",de),e.addEventListener("focus",ue,!0),e}(t)}function Qt({action:t,title:e,iconId:n}){return'\n        <button class="btn-icon pl-entry-btn" data-action="'+t+'" title="'+e+'">\n            '+p({iconId:n})+"\n        </button>\n    "}function te(t){let e=Math.floor(t/3600),n=Math.ceil(t/60%60);return 60===n&&(n=0,e+=1),e+" hr "+n+" min"}function ee(t){const e=function(t){const e="assets/images/album-art-placeholder.png",n=[];if(!t.length)return[e];const i=f(t.map(t=>t.thumbnail));for(const t of i){if(4===n.length)break;t!==e&&n.push(t)}if(!n.length)return[e];return n}(t);return'\n        <div class="pl-entry-thumbnail _'+e.length+'">\n            '+e.map(t=>'\n                <div class="pl-entry-thumb-image-container">\n                    <img src="'+u(t)+'" class="pl-entry-thumb-image" alt="">\n                </div>\n            ').join("")+"\n        </div>\n    "}function ne(t,e){const n=P(e);t.querySelector(".track-count").textContent=e.length+" tracks",t.querySelector(".playlist-duration").textContent=te(n)}function ie(t,e){o(t.querySelector(".pl-entry-thumbnail")),t.insertAdjacentHTML("afterbegin",ee(e))}function oe(t,e){const{children:n}=document.getElementById("js-pl-entries");for(const i of n)if(t===i.getAttribute("data-entry-id")){ne(i,e),ie(i,e);break}}function se(t,{element:e,pl:n}){e.insertAdjacentHTML("afterend",'\n        <div id="'+t+'" class="panel pl-entry-panel">\n            <h3 class="panel-title">Playlist settings</h3>\n            <label class="pl-entry-setting">\n                <input type="checkbox" class="checkbox-input" '+(n.syncOnInit?"checked":"")+'>\n                <div class="checkbox">\n                    <div class="checkbox-tick"></div>\n                </div>\n                <span>Synchronize playlist on startup</span>\n            </label>\n        </div>\n    '),document.getElementById(t).addEventListener("change",me)}function re(t){const{parentElement:e}=t;var n;o(t),e.children.length||((n=e).removeEventListener("click",de),n.removeEventListener("focus",ue,!0),o(n.parentElement))}async function ae(t){t.length&&(Wt(),t.forEach(({id:t})=>{d("import",{importing:!0,option:"youtube",playlistId:t})}),await dt(),t.forEach(({url:t})=>{zt("youtube",{url:t,type:"sync"})}))}function ce({currentTarget:t}){const{attrValue:e}=r("data-entry-id",t),n=A(e),i=t.value;var o;(t.removeEventListener("blur",ce),t.removeEventListener("keyup",le),i)?i!==n.title&&(n.title=i,o=i,tt(e).querySelector(".sidebar-link").textContent=o,oo({action:"change-title",playlist:{_id:n._id,title:i}})):t.value=n.title}function le({currentTarget:t,which:e}){13===e&&t.blur()}function de({target:t}){const e=r("data-entry-id",t),n=r("data-action",t);if(!e||!n||n.elementRef.disabled)return;const{attrValue:i,elementRef:s}=n,a=A(e.attrValue);"remove"===i?(!function({id:t,_id:e}){_(t)&&Li(q());(function(t){const e=Ri(t);e&&(Ui(t),o(e))})(t),function(t){delete I[t],delete L[t]}(t),function(t){o(tt(t))}(t),function(t){w=w.filter(e=>!e.includes(t))}(t),oo({action:"remove",playlist:{_id:e}})}(a),re(e.elementRef)):"sync"===i?ae([a]):"settings"===i?G("js-pl-entry-panel",se,{element:s,pl:a}):"edit"===i&&s.querySelector(".input").focus()}function ue({target:t}){const e=r("data-action",t);e&&"edit"===e.attrValue&&(t.addEventListener("blur",ce),t.addEventListener("keyup",le))}function me({target:t}){const{attrValue:e}=r("data-entry-id",t),n=A(e);n.syncOnInit=t.checked,oo({action:"change-sync",playlist:{_id:n._id,syncOnInit:n.syncOnInit}})}function fe({currentTarget:t,target:e}){const n=r("data-panel-item",e,t);if(!n)return;const{attrValue:i,elementRef:s}=n;"btn"===i?(no("move-to",s.parentElement,"beforeend",pe),o(s)):(t.removeEventListener("click",fe),function(t){const e=ze(Ne()),{tracks:n}=Mi(),i=A(t),o=n.filter(n=>e.includes(n.index)&&!W(t,n.name)).map(e=>Object.assign({},e,{playlistId:t}));to(i,o),s="playlist/"+i.id,window.location.hash="/"+s;var s}(i),Z(),Se())}function pe(t){const e=document.getElementById("js-move-to-list"),n=Oi();eo(t),e?e.innerHTML=ge(n):t.target.insertAdjacentHTML("beforebegin",ye(n))}function ge(t){return Object.keys(I).map(A).reduce((e,n)=>(n.id!==t&&(e+='\n                <li data-panel-item="'+n.id+'">\n                    <button class="btn-icon move-to-list-item-btn">'+n.title+"</button>\n                </li>\n            "),e),"")}function ye(t){const e=ge(t);return e?'<ul id="js-move-to-list" class="move-to-list">'+e+"</ul>":""}function ve(t,{playlistId:e}){document.getElementById("js-move-to-panel-container").insertAdjacentHTML("beforeend",'\n        <div id="'+t+'" class="panel move-to-panel">\n            <h3 class="panel-title move-to-panel-title">Move to</h3>\n            '+ye(e)+'\n            <button class="btn-icon move-to-new-pl-btn" data-panel-item="btn">\n                '+p({iconId:"plus"})+"\n                <span>Create new playlist</span>\n            </button>\n        </div>\n    ")}Vt.addEventListener("click",({currenTarget:t,target:e})=>{const n=r("data-item",e,t);if(!n||n.elementRef.disabled)return;const{attrValue:i}=r("data-option",e,t);"local"===i?Yt(n.attrValue):"dropbox"===i?Dropbox.choose({success(t){const e="dropbox";kt(e,A(e)||S({id:e,title:"Dropbox",type:"grid",storePlaylist:qt.getSetting(e,"storePlaylist")}),t,It)},linkType:"direct",multiselect:!0,extensions:["audio"]}):"youtube"===i&&$t(n)}),document.getElementById("js-import-settings-btn").addEventListener("click",({currentTarget:t})=>{G("js-import-settings-panel",Ft,{element:t})}),window.addEventListener("import",({detail:t})=>{const{importing:e,option:n,playlistId:i}=t;!function({children:t},e){Array.from(t).forEach(t=>{t.hasAttribute("data-item")&&(t.disabled=e)})}(document.querySelector("[data-option="+n+"]"),e),Nt(i,e),"local"===n&&(e?Vt.insertAdjacentHTML("afterend",'\n        <div id="js-import-progress" class="import-progress">\n            <p id="js-import-progress-label" class="import-progress-label"></p>\n            <div class="import-progress-bar">\n                <div id="js-import-progress-bar-inner" class="import-progress-bar-inner"></div>\n                <div id="js-import-progress-bar-label" class="import-progress-bar-label"></div>\n            </div>\n        </div>\n    '):o(document.getElementById("js-import-progress")))});const be={},he={};let we=null,ke=null,Ee=null,Ie={},Le=[],je=0,xe=!1,Te=!1;function Be(){we.removeEventListener("mousedown",De),we=null}function Ae(){Ne().forEach(t=>{t.classList.remove("selected")})}function Se(){Ae(),Me()}function Oe(){Te||(Te=!0,function(){const t="js-move-to-panel-container";document.getElementById("js-playlist-tab-header-items").insertAdjacentHTML("afterbegin",'\n        <div id="'+t+'" class="playlist-tab-header-item" data-move-to>\n            <button class="btn-icon" data-item="move-to" title="Move to">\n                '+p({iconId:"move-to"})+"\n            </button>\n        </div>\n    "),document.getElementById(t).addEventListener("click",fe)}(),setTimeout(()=>{window.addEventListener("click",qe,!0)},0),window.addEventListener("keypress",We))}function Me(){Te&&(Te=!1,function(){const t=document.getElementById("js-move-to-panel-container");t.removeEventListener("click",fe),o(t)}(),window.removeEventListener("click",qe,!0),window.removeEventListener("keypress",We))}function Re(t,e){return t>e?e:t<0?0:t}function Pe(){clearInterval(je),je=0}function He(t){xe=!0,requestAnimationFrame(()=>{Ee&&function(t,e,n,i){let o=t.x-e.x,s=t.y-e.y;if(o<0){const t=e.x+o;o*=-1,n.left=t,i.left=t+"px"}else n.left!==e.x&&(n.left=e.x,i.left=e.x+"px");if(s<0){const t=e.y+s;s*=-1,n.top=t,i.top=t+"px"}else n.top!==e.y&&(n.top=e.y,i.top=e.y+"px");n.right=n.left+o,n.bottom=n.top+s,i.width=o+"px",i.height=s+"px"}(he,be,Ie,Ee.style),function(t,e,n){for(let i=0;i<t.length;i++){const o=t[i],s=o.ref.classList;e.right>o.left&&e.left<o.right&&e.bottom>o.top&&e.top<o.bottom?(n&&!o.selected&&s.contains("selected")&&(s.remove("selected"),o.removed=!0),o.removed||(s.add("selected"),o.selected=!0)):o.selected?(s.remove("selected"),o.selected=!1):o.removed&&(s.add("selected"),o.removed=!1)}}(Le,Ie,t),xe=!1})}function Ce(t,e,{scrollHeight:n,height:i}){e.scrollTop+=36,he.y=e.scrollTop+i,he.y>=n&&(he.y=n,Pe()),xe||He(t)}function _e(t,e){e.scrollTop-=36,he.y=e.scrollTop,he.y<=0&&(he.y=0,Pe()),xe||He(t)}function Ve(t){const{top:e,left:n,width:i,height:o,scrollHeight:s}=ke,r=t.clientY-e;if(he.x=Re(t.clientX-n,i),he.y=Re(we.scrollTop+r,s),t.preventDefault(),!Ee&&function(t,e){return t.x>e.x+2||t.x<e.x-2||t.y>e.y+2||t.y<e.y-2}(he,be))return Le=function(){const{children:t}=qi(Oi());return Array.from(t).map(t=>{const e=t.offsetTop,n=t.offsetLeft;return{ref:t,top:e,left:n,right:n+t.offsetWidth,bottom:e+t.offsetHeight}})}(),Ee=function(t,{x:e,y:n}){return Ie.top=n,Ie.left=e,t.insertAdjacentHTML("afterbegin",'\n        <div class="selection-area" style="top: '+n+"px; left: "+e+'px"></div>\n    '),t.firstElementChild}(we,be),document.activeElement.blur(),t.ctrlKey||Ae(),void Me();if(xe||He(t.ctrlKey),je&&r>0&&r<o)Pe();else if(!je){let e=null;if(r>o&&he.y<s)e=Ce;else{if(!(r<0&&he.y>0))return;e=_e}je=setInterval(e,40,t.ctrlKey,we,ke)}}function Ue({target:t,ctrlKey:e}){if(je&&Pe(),Ee){const t=Ne();o(Ee),Ee=null,Ie={},Le.length=0,t.length?Oe():Me()}else{const n=r("data-index",t,we);n?function(t,e){if(e||Ae(),t.classList.toggle("selected"),t.classList.contains("selected"))Oe();else{const e=Ne();t.blur(),e.length||Me()}}(n.elementRef,e):e||Se()}window.removeEventListener("mousemove",Ve),window.removeEventListener("mouseup",Ue)}function qe({target:t}){!r("data-move-to",t)&&a(t,we)&&Se()}function De({currentTarget:t,target:e,which:n,clientX:i,clientY:o}){var s;1===n&&(r("data-btn",e)?Se():(ke={top:(s=t).offsetTop,left:s.offsetLeft,width:s.clientWidth,height:s.offsetHeight,scrollHeight:s.scrollHeight},be.x=i-ke.left,be.y=t.scrollTop+o-ke.top,be.x<ke.width&&(window.addEventListener("mousemove",Ve),window.addEventListener("mouseup",Ue))))}function We({key:t,keyCode:e}){"Delete"!==t&&127!==e||(!function(){const t=Ne(),e=Mi(),n=ze(t),{tracksToKeep:i,tracksToRemove:s}=function(t,e){const n=[],i=[];return t.forEach(t=>{e.includes(t.index)?i.push(t):n.push(t)}),{tracksToRemove:i,tracksToKeep:n}}(e.tracks,n);e.tracks=i,function(t){t.forEach(o)}(t),Y(e),function(t){const{sortOrder:e}=M(t);[...qi(t).children].forEach((t,n)=>{const i=t.querySelector(".list-item-index");i&&(i.textContent=n+1),t.setAttribute("data-index",e[n])})}(e.id),K(e),z(e.id,v("shuffle")),D(e.id),oe(e.id,i),i.length||(Be(),Ji(e));oo({action:"remove-tracks",playlist:{_id:e._id,tracks:s}})}(),Me())}function Ne(){return Array.from(we.querySelectorAll(".track.selected"))}function ze(t){return t.map(t=>parseInt(t.getAttribute("data-index"),10))}n(115);const Xe=document.getElementById("js-filter-input"),Ye=Xe.parentElement;let Je=0,Ke="";function Fe(t,e,n){const i=new RegExp(n,"i");t.forEach(t=>{const n=e[t.index],o="\n            "+t.title+"\n            "+t.artist+"\n            "+t.album+"\n        ";n.classList.toggle("hidden",!i.test(o))})}function Ze(t,e=""){const{tracks:n}=A(t);if(!n.length)return;const{children:i}=qi(t);var o;Ke=e?t:"",Fe(n,i,e),o=e,document.getElementById("js-clear-input-btn").classList.toggle("visible",o)}function $e(){Ke&&(Xe.value="",Ze(Ke))}function Ge(){Ye.classList.remove("active"),Xe.removeEventListener("keyup",Qe),Xe.removeEventListener("blur",Ge)}function Qe({target:t}){const e=Oi();clearTimeout(Je),Je=setTimeout(Ze,400,e,t.value)}function tn(t){document.getElementById("js-order-toggle").querySelector("use").setAttribute("href","#"+(1===t?"down":"up")+"-arrow")}function en(t,e){const{value:n}=document.getElementById("js-filter-input");if(t.order=t.sortedBy===e&&1===t.order?-1:1,t.sortedBy=e,K(t),oo({action:"change-sorting",playlist:{order:t.order,_id:t._id,sortedBy:e}}),D(t.id),Ji(t),n){const{children:e}=qi(t.id);Fe(t.tracks,e,n)}}function nn({sortedBy:t,order:e}){var n;n=t,document.getElementById("js-sort-toggle").textContent=n,tn(e)}function on(t,{sortedBy:e}){document.getElementById("js-sort-panel-container").insertAdjacentHTML("beforeend",function(t,e){return'<ul id="'+t+'" class="panel sort-panel">'+function(t){return["index","title","artist","album","duration"].reduce((e,n)=>{const i=n===t?" active":"";return"\n            "+e+'\n            <li>\n                <button class="btn-icon sort-option-btn'+i+'" data-sort="'+n+'">\n                    '+n+"\n                </button>\n            </li>\n        "},"")}(e)+"</ul>"}(t,e)),document.getElementById(t).addEventListener("click",sn)}function sn({currentTarget:t,target:e}){const n=e.getAttribute("data-sort"),i=Mi();t.removeEventListener("click",sn),Z(),n!==i.sortedBy&&(nn({sortedBy:n,order:1}),en(i,n))}Xe.addEventListener("focus",({currentTarget:t})=>{Ye.classList.add("active"),t.addEventListener("keyup",Qe),t.addEventListener("blur",Ge)}),Ye.addEventListener("click",({target:t})=>{const e=r("data-filter-item",t);if(!e)return;const n=e.attrValue;"icon"===n?Xe.focus():"button"===n&&($e(),Ge())});const rn=document.getElementById("js-volume-slider"),an=document.getElementById("js-track-slider"),cn=document.getElementById("js-controls");let ln=!1;const dn=function(){let t=0;function e(){clearTimeout(t)}function n(e,i,o){const s=performance.now()-i-o;ln||In(e,e.currentTime),fi.updateTrack({currentTime:e.currentTime}),e.currentTime<=e.durationInSeconds?(e.currentTime+=1,o+=1e3,t=setTimeout(n,1e3-s,e,i,o)):d("track-end")}return{stop:e,start:function(t){const i=performance.now();e(),n(t,i,0)}}}();function un(t){const e=Di(t);e&&e.classList.add("show-spinner"),document.getElementById("js-play-btn").classList.add("show-spinner")}function mn(t){const e=Di(t);e&&e.classList.remove("show-spinner"),document.getElementById("js-play-btn").classList.remove("show-spinner")}function fn(t){return t?{id:"play",title:"Play"}:{id:"pause",title:"Pause"}}function pn(t,e){m(t,fn(e))}function gn(t,e){const n={on:{id:"volume-off",title:"Unmute"},off:{id:"volume",title:"Mute"}};m(t,e?n.on:n.off)}function yn(t,e){const{left:n,width:i}=document.getElementById("js-"+t+"-slider").getBoundingClientRect();let o=(e-n)/i*100;return o<0?o=0:o>100&&(o=100),o}function vn(){dn.stop(),In()}function bn(t){y("volume",t),Ln(t),function(t){const e=q()||{};"native"===e.player?Zn(t):"youtube"===e.player&&ui(t)}(t)}function hn(t,e){const n=e/2;return t+n+8>window.innerWidth||t-n-8<0}function wn(t,e){return"calc("+t+"% - "+e+"px)"}function kn(t,e){const n=document.getElementById("js-volume-slider-label");n.textContent=Math.floor(t)+"%";const i=n.offsetWidth;hn(e,i)||(n.style.left=wn(t,i/2))}function En(t,e){document.getElementById("js-"+t+"-slider-thumb").style.left=100*e+"%",document.getElementById("js-"+t+"-slider-elapsed").style.transform="scaleX("+e+")"}function In(t,e=0){let n=1,i="0:00";t&&(n=t.durationInSeconds,i=t.duration);const o=l(e,n>=3600);ln||(document.getElementById("js-track-current").textContent=o),En("track",e/n),an.setAttribute("aria-valuenow",e),an.setAttribute("aria-valuetext",o+" of "+i)}function Ln(t){const e=Math.floor(100*t);En("volume",t),rn.setAttribute("aria-valuenow",e),rn.setAttribute("aria-valuetext",e+"% volume")}function jn(t="0:00",e=0){document.getElementById("js-track-duration").textContent=t,an.setAttribute("aria-valuemax",e)}function xn(t,e){const n=yn("track",t);return{percent:n,currentTime:Math.floor(e*n/100)}}function Tn(t,e,n){const i=document.getElementById("js-track-slider-label");i.textContent=l(e);const o=i.offsetWidth;hn(n,o)||(i.style.left=wn(t,o/2))}function Bn({pageX:t}){const e=q(),{percent:n,currentTime:i}=xn(t,e.durationInSeconds);In(e,i),Tn(n,i,t)}function An({pageX:t}){const e=q();if(!e)return;const{percent:n,currentTime:i}=xn(t,e.durationInSeconds);Tn(n,i,t)}function Sn({pageX:t}){const e=q();if(ln=!1,e){const{currentTime:n}=xn(t,e.durationInSeconds);In(e,n),xi(e.player,n),fi.updateTrack({currentTime:n})}window.removeEventListener("mousemove",Bn),window.removeEventListener("mouseup",Sn),an.addEventListener("mousemove",An)}function On({pageX:t}){const e=yn("volume",t),n=e/100;n!==v("volume")&&(kn(e,t),n?(Hn(),bn(n)):Pn({attrValue:"mute",elementRef:document.getElementById("js-volume-btn")}))}function Mn({pageX:t}){kn(yn("volume",t),t)}function Rn(){window.removeEventListener("mousemove",On),window.removeEventListener("mouseup",Rn),rn.addEventListener("mousemove",Mn)}function Pn({attrValue:t,elementRef:e}){const n=!v(t);e.setAttribute("aria-checked",n),y(t,n),"mute"===t?(!function(t){const e=t?0:v("volumeBeforeMute");t?y("volumeBeforeMute",v("volume")):b("volumeBeforeMute");bn(e)}(n),gn(e,n)):e.classList.toggle("active")}function Hn(){const t=v("mute");if(t){const e=document.getElementById("js-volume-btn");b("volumeBeforeMute"),y("mute",!t),gn(e,!t),e.classList.remove("active")}}function Cn(t){return function({pageX:e}){const n=document.getElementById("js-"+t+"-slider-label"),i=window.innerWidth,o=n.offsetWidth/2;if(e+o+8>i){const e=yn(t,i-o-8);n.style.left=wn(e,o)}else if(e-o-8<0){const e=yn(t,o+8);n.style.left=wn(e,o)}}}an.addEventListener("mousedown",t=>{1===t.which&&q()&&(ln=!0,Bn(t),an.removeEventListener("mousemove",An),window.addEventListener("mousemove",Bn),window.addEventListener("mouseup",Sn))}),an.addEventListener("mousemove",An),an.addEventListener("mouseenter",Cn("track")),an.addEventListener("keydown",({key:t})=>{if(!t.startsWith("Arrow"))return;const e=q();if(!e)return;const n=e.durationInSeconds;let{currentTime:i}=fi.getTrack();"ArrowRight"===t||"ArrowUp"===t?(i+=5)>n&&(i=n):"ArrowLeft"!==t&&"ArrowDown"!==t||(i-=5)<0&&(i=0),In(e,i),xi(e.player,i),fi.updateTrack({currentTime:i})}),rn.addEventListener("mousedown",t=>{1===t.which&&(On(t),rn.removeEventListener("mousemove",Mn),window.addEventListener("mousemove",On),window.addEventListener("mouseup",Rn))}),rn.addEventListener("mousemove",Mn),rn.addEventListener("mouseenter",Cn("volume")),rn.addEventListener("keydown",({key:t})=>{if(!t.startsWith("Arrow"))return;let e=v("volume");if(e<1&&("ArrowRight"===t||"ArrowUp"===t))e||Hn(),(e+=.05)>1&&(e=1);else if(e&&("ArrowLeft"===t||"ArrowDown"===t)&&(e-=.05)<=0)return e=0,void Pn({attrValue:"mute",elementRef:document.getElementById("js-volume-btn")});bn(e)}),document.getElementById("js-main-controls").addEventListener("click",({target:t})=>{const e=r("data-item",t);if(e)switch(e.attrValue){case"previous":wi("direction",-1,C());break;case"play":!function(){const t=q();t?bi(t):wi("direction",0,Oi())}();break;case"next":ki()}}),cn.addEventListener("click",({target:t})=>{const e=r("data-item",t);e&&Pn(e)}),cn.addEventListener("keyup",({which:t,target:e})=>{const n=r("data-item",e);!n||32!==t&&13!==t||Pn(n)}),document.getElementById("js-control-toggle-btn").addEventListener("click",()=>{cn.classList.toggle("visible")}),Ln(v("volume")),Array.from(document.querySelectorAll(".control-btn")).forEach(t=>{const e=t.getAttribute("data-item"),n=v(e);n&&(t.setAttribute("aria-checked",!0),"mute"===e?gn(t,n):t.classList.add("active"))});const _n=document.getElementById("js-now-playing"),Vn=document.getElementById("js-media-toggle-btn"),Un=document.getElementById("js-media-container");let qn,Dn,Wn=null,Nn=!1;function zn(t){27===t.which&&(Nn=!1,Un.classList.remove("visible"),window.removeEventListener("keydown",zn),m(Vn,{title:"Expand",id:"expand"}))}function Xn(){const t=document.getElementById("js-track-info");t&&o(t)}function Yn(t="./assets/images/album-art-placeholder.png"){document.getElementById("js-artwork").src=t}function Jn(t,e){Yn(),Xn(),function(t,e){Yn(e),_n.classList.remove("inactive"),_n.insertAdjacentHTML("beforeend",function(t,e){let n="<div>"+t.name+"</div>";return t.artist&&t.title&&(n='\n            <div class="track-title">'+t.title+"</div>\n            <div>"+t.artist+" "+(t.album?"- "+t.album:"")+"</div>\n        "),'<div id="'+e+'" class="track-info fade-right">'+n+"</div> "}(t,"js-track-info"))}(t,e)}function Kn(t){Wn&&URL.revokeObjectURL(Wn),Jn(t,Wn=u(t.thumbnail)),function(t,e){const n=document.getElementById("js-media-image");"native"===t?(n.classList.remove("hidden"),n.src=e):n.classList.add("hidden")}(t.player,Wn)}function Fn(){document.title="Veery",Yn(),Xn(),_n.classList.add("inactive"),Un.classList.remove("visible"),Wn&&(URL.revokeObjectURL(Wn),Wn=null)}function Zn(t){Dn.volume=t}function $n(t){Dn.currentTime=t}Vn.addEventListener("click",function({currentTarget:t}){const e=document.getElementById("js-yt-player");Un.classList.toggle("visible"),(Nn=!Nn)?(window.addEventListener("keydown",zn),m(t,{title:"Collapse",id:"collapse"}),e.removeAttribute("tabindex")):(window.removeEventListener("keydown",zn),m(t,{title:"Expand",id:"expand"}),e.setAttribute("tabindex","-1"))}),Un.addEventListener("click",function({target:t}){const e=r("data-item",t);e&&"image"===e.attrValue&&bi(q())});const Gn=1,Qn=2,ti=3;let ei=!1,ni=null,ii=!1,oi=null,si=!1;function ri({data:t}){const e=q();e&&"youtube"===e.player&&(t===Gn?(si||gi(e,!1),si=!1,d("track-start",ni.getCurrentTime())):t===Qn?(si||gi(e,!0),si=!1,mn(e)):t===ti?(dn.stop(),un(e)):mn(e))}function ai(){const{id:t,volume:e,startTime:n}=oi;ei=!0,"number"==typeof n?(ui(e),ni.cueVideoById(t,n),ii=!0):di(t,e)}function ci(t){let e="";if(100===t.data?e="Video is either removed or marked as private":101!==t.data&&150!==t.data||(e="The owner of the requested video does not allow it to be played in embedded players"),console.log(t),e){const t=q(),{name:n}=X(t.playlistId,1);t.name===n?Li(t):ki(),vt({title:"Cannot play "+t.name,body:e})}}function li(){ni=new YT.Player("js-yt-player",{playerVars:{autoplay:0,disablekb:1,controls:0,fs:0,iv_load_policy:3},events:{onReady:ai,onStateChange:ri,onError:ci}})}function di(t,e,n){if(ei)return ui(e),void ni.loadVideoById(t,n);oi={id:t,volume:e,startTime:n},window.onYouTubeIframeAPIReady=li,i.load({src:"https://www.youtube.com/iframe_api"})}function ui(t){ei&&ni.setVolume(100*t)}let mi=!0;const fi=function(){function t(){return JSON.parse(localStorage.getItem("track"))||{}}function e(t){localStorage.setItem("track",JSON.stringify(t))}function n(){localStorage.removeItem("track")}return{getTrack:t,removeTrack:n,saveTrack:e,updateTrack:function(n){e(Object.assign(t(),n))},initTrack:function(){const e=t();if(!e)return;const i=V(W(e.playlistId,e.name));i?(hi(i,{startTime:e.currentTime}),In(i,e.currentTime)):n()}}}();function pi(){return mi}function gi(t,e){(mi="boolean"==typeof e?e:!mi)&&(et(),dn.stop()),vi(t,mi),Ti()}function yi(t,{scrollToTrack:e,startTime:n}){const{rendered:i}=M(t.playlistId);Kn(t),jn(t.duration,t.durationInSeconds),an.classList.add("visible"),H(t.playlistId),N(t.playlistId,t.index),U(t),i&&-1!==t.index&&Fi(t,e),void 0===n?(mi=!1,Ti(),un(t),vi(t,mi)):mi=!0}function vi(t,e){pn(document.getElementById("js-play-btn"),e),Zi(t,e)}function bi(t){"native"===t.player?mi?Dn.play():Dn.pause():"youtube"===t.player&&function(t){ei&&(si=!0,ii=!1,t?ni.playVideo():ni.pauseVideo())}(mi),gi(t)}function hi(t,e={}){const n=v("volume");yi(t,e),"native"===t.player?function(t,e,n){qn=URL.createObjectURL(t.audioTrack),(Dn=new Audio(qn)).onplaying=function(){d("track-start",Dn.currentTime)},Dn.onerror=function(t){const e=q(),{name:n}=X(e.playlistId,1);e.name===n?Li(e):ki(),vt({title:"Cannot play "+e.name,body:"Its path or name might have changed"}),console.log(t)},Zn(e),"number"!=typeof n?Dn.play():$n(n)}(t,n,e.startTime):"youtube"===t.player&&di(t.id,n,e.startTime)}function wi(t,e,n){if(!n)return;const i=v("shuffle"),o=q(),{shuffled:s}=M(n);let r=!1;if(o&&(Ki(o.element),vn(),Zi(o,!0),Ii(o)),n===C()&&s===i||(r=!0,z(n,i)),"index"===t){const{tracks:t}=A(n);!r&&i&&z(n,i),hi(V(t[e]))}else if("direction"===t){const t=X(n,e);t?hi(t,{scrollToTrack:!0}):ji(o)}}function ki(){wi("direction",1,C())}function Ei({currentTarget:t,detail:e,target:n}){const i=Oi(),o=r("data-btn",n,t),s=r("data-index",n,t);if(2===e&&s&&!o)wi("index",s.attrValue,i);else if(o){const t=parseInt(s.attrValue,10),e=q();e&&e.playlistId===i&&t===e.index?bi(e):wi("index",t,i)}}function Ii(t){"native"===t.player?(Dn.pause(),Dn.onplaying=null,Dn.onerror=null,Dn.currentTime=0,Dn=null,qn&&(URL.revokeObjectURL(qn),qn=null)):"youtube"===t.player&&function(t){ei&&(mn(t),ni.stopVideo(),ii=!1)}(t)}function Li(t){t&&Ii(t),ji(t)}function ji(t){mi=!0,fi.removeTrack(),jn(),an.classList.remove("visible"),Fn(),U(),H(),et(),t&&(Ki(t.element),vn(),mn(t),vi(t,mi))}function xi(t,e){dn.stop(),"native"===t?$n(e):"youtube"===t&&function(t){ei&&(ii?ni.cueVideoById(oi.id,t):ni.seekTo(t,!0))}(e)}function Ti(t=Oi()){const e=pi(),n=A(t);let i="Veery";if(e)n&&(i=n.title+" | "+i);else{const{artist:t,name:e,title:n}=q();i=(t&&n?t+" - "+n:e)+" | "+i}document.title=i}window.addEventListener("track-start",({detail:t})=>{const e=q();!function(t){const e=tt(t);et(),e.insertAdjacentHTML("beforeend",p({iconId:"volume",elementId:"js-active-playlist-icon",className:"active-playlist-icon"}))}(e.playlistId),fi.saveTrack({name:e.name,playlistId:e.playlistId}),dn.start({currentTime:Math.floor(t),duration:e.duration,durationInSeconds:e.durationInSeconds}),mn(e)}),window.addEventListener("track-end",()=>{const t=q();v("once")?Li(t):(fi.removeTrack(),v("repeat")?hi(t):ki())});const Bi=document.getElementById("js-tab-header"),Ai=matchMedia("(max-width: 540px)");let Si="";function Oi(){return Si}function Mi(){return A(Si)}function Ri(t){return document.getElementById("js-tab-"+t)}function Pi(t){const e=A(t),{rendered:n}=M(t);n||function(t){const e=function(t){const e=Xi(t);return'<div id="js-tab-'+t.id+'" class="tab">'+e+"</div>"}(t);document.getElementById("js-tabs").insertAdjacentHTML("beforeend",e),R(t.id,{rendered:!0}),t.tracks.length&&(Yi(t.id),Vi(t.id))}(e),"list"===e.type&&Ai.matches?Gi(e,"grid"):$i(e.type),nn(e),function({id:t,tracks:e}){we&&Be(),e.length&&(we=Ri(t)).addEventListener("mousedown",De)}(e),$e(),e.tracks.length&&Ri(t).addEventListener("click",Ei)}Bi.addEventListener("click",({currentTarget:t,target:e})=>{const n=r("data-item",e,t);if(!n)return;const i=Mi(),o=n.attrValue;"move-to"===o?G("js-move-to-panel",ve,{playlistId:i.id,element:n.elementRef}):"list"!==o&&"grid"!==o||o===i.type?"sorting"===o?G("js-sort-panel",on,{sortedBy:i.sortedBy,element:n.elementRef}):"order"===o&&i.sortedBy?function(t){en(t,t.sortedBy),tn(t.order)}(i):"sidebar"===o&&document.getElementById("js-sidebar-container").classList.remove("hidden"):Gi(i,o)}),window.addEventListener("route-change",({detail:{isPlaylistTab:t,tabId:e}})=>{const n=Ri(Si);s(".sidebar-entry.active","active"),s(".tab.active","active"),function(t=""){Si=t}(t?e:""),n&&n.removeEventListener("click",Ei),t?(Pi(e),Bi.classList.add("playlist-tab-active")):Bi.classList.remove("playlist-tab-active"),Ti(e),Ri(e).classList.add("active"),"not-found"!==e&&tt(e).classList.add("active")}),Ai.onchange=function({matches:t}){const e=Mi();t&&e&&"list"===e.type&&Gi(e,"grid")};const Hi={};function Ci(t){const{tracks:e,type:n}=Mi(),i=e[t.getAttribute("data-index")];t.innerHTML=function(t,e){const n=function(t){const e=q(),n=pi();return e&&e.index===t?fn(n):fn(!0)}(t.index);return"list"===e?function(t,{title:e,id:n}){const{sortOrder:i}=M(t.playlistId);return'\n        <span class="list-item-first-col">\n            <span class="list-item-index">'+(i.indexOf(t.index)+1)+'</span>\n            <button class="btn-icon track-play-pause-btn" data-btn="play" title="'+e+'">\n                '+p({iconId:n})+'\n            </button>\n        </span>\n        <span class="list-item-col fade-right">'+t.title+'</span>\n        <span class="list-item-col fade-right">'+t.artist+'</span>\n        <span class="list-item-col fade-right">'+t.album+'</span>\n        <span class="list-item-last-col">'+t.duration+"</span>\n    "}(t,n):function(t,{title:e,id:n}){return'\n        <div class="artwork-container grid-item-thumbnail" tabindex="-1">\n            <button class="btn-icon track-play-pause-btn artwork-container-btn" data-btn="play" title="'+e+'">\n                '+p({iconId:n})+'\n            </button>\n            <img src="'+u(t.thumbnail)+'" class="artwork" alt="">\n        </div>\n        '+function(t){let e=t.name;t.artist&&t.title&&(e='\n            <div class="track-title">'+t.title+"</div>\n            <div>"+t.artist+" "+(t.album?"- "+t.album:"")+"</div>\n        ");return'<div class="track-info fade-right">'+e+"</div> "}(t)+'\n        <div class="grid-item-duration">'+t.duration+"</div>\n    "}(t,n)}(i,n)}function _i(t){t.forEach(({isIntersecting:t,target:e})=>{t?Ci(e):e.childElementCount&&function(t){const e=t.querySelector(".artwork");e&&URL.revokeObjectURL(e.src),t.innerHTML=""}(e)})}function Vi(t){if(!IntersectionObserver||Hi[t])return;Hi[t]=new IntersectionObserver(_i,{root:Ri(t)});const{children:e}=qi(t);!function(t,e){e.forEach(e=>{Hi[t].observe(e)})}(t,Array.from(e))}function Ui(t){Hi[t]&&(Hi[t].disconnect(),delete Hi[t])}function qi(t){return document.getElementById("js-"+t)}function Di({element:t,index:e}){if(e>=0&&t)return t.querySelector(".btn-icon")}function Wi({index:t}){return'<li class="list-item track" data-index="'+t+'" tabindex="0"></li>'}function Ni({index:t}){return'<li class="grid-item track" data-index="'+t+'" tabindex="0"></li>'}function zi(t,e,n){return e.reduce((e,i)=>e+n(t[i]),"")}function Xi(t){return t.tracks.length?function({id:t,type:e,tracks:n}){const{sortOrder:i}=M(t);return"list"===e?function(t,e){return'\n        <ul class="list-view-header">\n            <li class="list-item-first-col">#</li>\n            <li>Title</li>\n            <li>Artist</li>\n            <li>Album</li>\n            <li class="list-item-last-col">Duration</li>\n        </ul>\n        <ul id="js-'+t+'" class="playlist-view">'+e+"</ul>\n    "}(t,zi(n,i,Wi)):function(t,e){return'<ul id="js-'+t+'" class="playlist-view grid-view">'+e+"</ul>"}(t,zi(n,i,Ni))}(t):'<p class="playlist-message">This playlist is empty</p>'}function Yi(t){const e=q();e&&e.playlistId===t&&-1!==e.index&&Fi(e,!0)}function Ji(t){var e;Ri(t.id).innerHTML=Xi(t),t.tracks.length?(Yi(t.id),e=t.id,Hi[e]&&Ui(e),Vi(e)):Ui(t.id)}function Ki(t){t&&t.classList.remove("playing")}function Fi(t,e){!function(t){const{sortOrder:e}=M(t.playlistId),n=e.indexOf(t.index);t.element=document.getElementById("js-"+t.playlistId).children[n],t.element.classList.add("playing")}(t),e&&function(t,e){const n=Ri(e),{offsetHeight:i,offsetTop:o}=t,{clientHeight:s,scrollTop:r}=n,a=r+s;(o-i<r||o>a)&&(n.scrollTop=o-s/2)}(t.element,t.playlistId)}function Zi(t,e){const n=Di(t);n&&pn(n,e)}function $i(t){const e=document.getElementById("js-list-toggle-btn"),n=document.getElementById("js-grid-toggle-btn");"list"===t?(e.classList.add("active"),n.classList.remove("active")):(n.classList.add("active"),e.classList.remove("active"))}function Gi(t,e){t.type=e,oo({action:"change-type",playlist:{_id:t._id,type:e}}),Ji(t),$i(e)}function Qi(t){var e,n,i;R(t.id,{initialized:!0}),e=t.title,n=t.id,document.getElementById("js-sidebar-entries").insertAdjacentHTML("beforeend",'\n        <li id="js-sidebar-entry-'+n+'" class="sidebar-entry">\n            <a href="./#/playlist/'+n+'" class="sidebar-link" data-link>\n                <div class="fade-right">'+e+"</div>\n            </a>\n        </li>\n    "),function(t){const e=Gt(),n=P(t.tracks),i=p({iconId:"link"}),o=t.url?'<a href="'+t.url+'"\n            class="btn-icon pl-entry-btn" target="_blank"\n            title="Open playlist on YouTube">\n            '+i+"\n        </a>\n    ":"",s=t.url?Qt({action:"sync",title:"Synchronize playlist",iconId:"sync"}):"",r=t.url?'\n        <div class="pl-entry-panel-container">\n            '+Qt({action:"settings",title:"Settings",iconId:"settings"})+"\n        </div>\n    ":"",a=Qt({action:"remove",title:"Remove playlist",iconId:"trash"}),c=p({iconId:"edit",className:"pl-entry-input-icon"}),l=t.storePlaylist?"":p({iconId:"alert",className:"pl-entry-stats-item",title:"This playlist will not be stored"}),d=t.isPrivate?p({iconId:"lock",className:"pl-entry-stats-item",title:t.user?"Private to "+t.user.name:"Private"}):"";e.insertAdjacentHTML("beforeend",'\n        <li class="pl-entry" data-entry-id='+t.id+">\n            "+ee(t.tracks)+'\n            <div class="pl-entry-content">\n                <div class="pl-entry-input-container" data-action="edit">\n                    <input type="text" class="input pl-entry-input" value="'+t.title+'">\n                    '+c+'\n                </div>\n                <div class="pl-entry-footer">\n                    <div class="pl-entry-stats">\n                        '+l+"\n                        "+d+'\n                        <span class="pl-entry-stats-item track-count">'+t.tracks.length+' tracks</span>\n                        <span class="pl-entry-stats-item playlist-duration">'+te(n)+"</span>\n                    </div>\n                    "+o+"\n                    "+s+"\n                    "+r+"\n                    "+a+"\n                </div>\n            </div>\n        </li>\n    ")}(t),Y(t),K(t),k(i="playlist/"+t.id)||w.push(i)}function to(t,e){const{initialized:n,rendered:i}=M(t.id);e.length&&(t.tracks=t.tracks.concat(e)),n?(Y(t),_(t.id)&&z(t.id,v("shuffle")),K(t),D(t.id),oe(t.id,t.tracks),i&&Ji(t),oo({action:"add-tracks",playlist:{_id:t._id,tracks:e}})):(Qi(t),t.storePlaylist&&oo({action:"add",playlist:t}))}function eo(t){const e=S({title:t.target.title.value,id:Math.random().toString(36).slice(2),storePlaylist:!0,type:"grid"});Qi(e),oo({action:"add",playlist:e}),t.preventDefault(),t.target.reset()}function no(t,e,n,i){e.insertAdjacentHTML(n,'\n        <form id="js-'+t+'-form" class="'+t+'-form">\n            <input type="text" name="title" class="input" autocomplete="off" placeholder="Playlist title" required>\n            <button class="btn">Create</button>\n        </form>\n    ');const o=document.getElementById("js-"+t+"-form");o.elements.title.focus(),o.addEventListener("submit",i)}const io=new Worker("./ww.js");function oo(t){("add"===t.action||t.playlist._id)&&io.postMessage(t)}io.onmessage=function({data:{action:t,payload:e}}){"init"===t?(e.forEach(t=>{Qi(S(t))}),ae(e.filter(t=>t.syncOnInit)),fi.initTrack(),E()):"update"===t&&O(e.id,e)},io.onerror=function(t){console.log(t)},"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("./sw.js").then(t=>{t.onupdatefound=(()=>{const e=t.installing;e.onstatechange=(()=>{"installed"===e.state&&navigator.serviceWorker.controller&&d("sw-state-change","update")})})}).catch(console.log)})},84:function(t,e,n){},85:function(t,e,n){}});