!function(t){function e(e){for(var i,a,r=e[0],l=e[1],c=e[2],u=0,m=[];u<r.length;u++)a=r[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&m.push(o[a][0]),o[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);for(d&&d(e);m.length;)m.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],i=!0,r=1;r<n.length;r++){var l=n[r];0!==o[l]&&(i=!1)}i&&(s.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},o={0:0},s=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var r=window.webpackJsonp=window.webpackJsonp||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;s.push([128,1]),n()}({128:function(t,e,n){"use strict";n.r(e);n(91),n(92),n(93),n(94),n(11),n(4),n(19);const i=function(){const t=[];return{load:function(e){return t.includes(e.src)?Promise.resolve():new Promise(n=>{const i=document.createElement("script");Object.keys(e).forEach(t=>{i.setAttribute(t,e[t])}),document.getElementsByTagName("body")[0].appendChild(i),t.push(e.src),i.onload=n})}}}();function o(t){t.remove()}function s(t,e){const n=document.querySelector(t);n&&n.classList.remove(e)}function a(t,e,n){for(void 0===n&&(n=null);e&&e!==n;){if(e.hasAttribute(t))return{elementRef:e,attrValue:e.getAttribute(t)};e=e.parentElement}}function r(t,e){return!!e&&!e.contains(t)}function l(t,e){return void 0===e&&(e=!0),e&&t<10?`0${t}`:t}function c(t,e){void 0===e&&(e=!1);const n=function(t){return Math.floor(t/3600)}(t),i=function(t){return Math.floor(t/60%60)}(t),o=function(t){return t%60}(t);return`${(e=e||n)?`${n}:`:""}${l(i,e)}:${l(o)}`}function d(t,e){const n=new CustomEvent(t,{detail:e});window.dispatchEvent(n)}function u(t){return"object"==typeof t?URL.createObjectURL(t):t}function m(t,e){let{id:n,title:i}=e;t.setAttribute("title",i),t.querySelector("use").setAttribute("href",`#${n}`)}function f(t){let e=t.length;for(;e;){const n=Math.floor(Math.random()*e);e-=1,[t[e],t[n]]=[t[n],t[e]]}return t}function p(t){return`\n        <svg viewBox="0 0 24 24" ${t.elementId?`id=${t.elementId}`:""} ${t.className?`class="${t.className}"`:""}>\n            ${t.title?`<title>${t.title}</title>`:""}\n            <use href="#${t.iconId}"></use>\n        </svg>\n    `}n(26);const y=Object.assign({playback:"normal",shuffle:!1,mute:!1,volume:.4},JSON.parse(localStorage.getItem("settings"))||{});function v(t,e){y[t]=e,h(y)}function g(t){return y[t]}function b(t){delete y[t],h(y)}function h(t){localStorage.setItem("settings",JSON.stringify(t))}n(31),n(119),n(88),n(51);let w=[];function k(t){return w.some(e=>e===t)}function E(t){window.location.hash=`/${t}`}function L(){const t=window.location.hash.slice(2).replace(/\/+$/g,"");let e=!1,n="home";t&&!k(t)?n="not-found":(e=t.startsWith("playlist/"),n=e?t.split("playlist/")[1]:n),d("route-change",{tabId:n,isPlaylistTab:e})}window.addEventListener("hashchange",L);const I={},$={};let j="",T=null,x=-1,B=[];function A(){return Object.keys(I).map(S)}function S(t){return I[t]}function O(t){return $[t.id]={shuffled:!1,sortOrder:[]},I[t.id]=Object.assign({sortedBy:"index",order:1,tracks:[]},t),I[t.id]}function M(t,e){Object.assign(I[t],e)}function R(t){return $[t]}function P(t,e){Object.assign($[t],e)}function H(t){return t.reduce((t,e)=>t+=e.durationInSeconds,0)}function C(t){void 0===t&&(t=""),j=t}function _(){return j}function V(t){return t===j}function q(t){T=t}function U(){return T}function D(t){const e=U();if(e&&V(t)){const i=W(t,e.name),o=i?i.index:-1;n={index:o},Object.assign(T,n),N(o,t)}var n}function W(t,e){const n=I[t];return n?n.tracks.find(t=>t.name===e):null}function N(t,e){const{sortOrder:n}=$[e],i=n.indexOf(t);x=B.indexOf(i),x=x<0?0:x}function Y(){return B}function z(t){for(let e=0;e<B.length;e++)if(B[e]===t){[B[0],B[e]]=[t,B[0]];break}}function K(t,e,n){void 0===n&&(n=-1);const i=U(),{tracks:o}=I[t],s=o.map(t=>{let{index:e}=t;return e});$[t].shuffled=e,B=e?f(s):s,e&&n>=0&&z(n),i&&N(i.index,t)}function F(t,e){const n=function(t){let e=x;return e+=t,!t||e>=B.length?e=0:-1===e&&(e=B.length-1),B[e]}(e),{tracks:i}=I[t],{sortOrder:o}=$[t],s=o[n];return(a=i[s])?Object.assign({},a):null;var a}function X(t){t.tracks=t.tracks.map((t,e)=>(t.index=e,t))}function J(t,e){return"index"===t?e.index:"duration"===t?e.durationInSeconds:e[t].toLowerCase()}function G(t){var e,n,i;$[t.id].sortOrder=(e=t.tracks,n=t.sortedBy,i=t.order,[...e].sort((t,e)=>{const o=J(n,t),s=J(n,e);return o<s?-i:o>s?i:0}).map(t=>{let{index:e}=t;return e}))}n(89);let Z=null;function Q(){window.removeEventListener("click",nt,!0),o(Z.element),Z=null}function tt(t,e,n){void 0===n&&(n={}),e(t,n),Z={id:t,element:document.getElementById(t),removeOnClick:n.removeOnClick,initiator:n.element},window.addEventListener("click",nt,!0)}function et(t,e,n){if(Z){const i=Z.id;Q(),i!==t&&tt(t,e,n)}else tt(t,e,n)}function nt(t){let{target:e}=t;if(Z.removeOnClick)return void Q();const{element:n,initiator:i}=Z,o=r(e,n),s=!!i&&r(e,i);o&&s&&Q()}function it(t){return document.getElementById(`js-sidebar-entry-${t}`)}function ot(){const t=document.getElementById("js-active-playlist-icon");t&&o(t)}function st(t,e){let{element:n}=e;n.insertAdjacentHTML("afterend",`\n        <form id="${t}" class="panel sidebar-form">\n            <h3 class="panel-title">Create Playlist</h3>\n            <div class="sidebar-form-input-container">\n                <input type="text" name="title" class="input sidebar-form-input"\n                    autocomplete="off" placeholder="Title" required>\n                <button class="btn">Create</button>\n            </div>\n        </form>\n    `);const i=document.getElementById(t);i.elements.title.focus(),i.addEventListener("submit",at)}function at(t){Oo(t),Q()}document.getElementById("js-sidebar-container").addEventListener("click",t=>{let{currentTarget:e,target:n}=t;if(a("data-link",n,e)||r(n,e.firstElementChild))return void e.classList.add("hidden");const i=a("data-btn",n,e);i&&et("js-sidebar-form-panel",st,{element:i.elementRef})}),window.addEventListener("connectivity-status",t=>{let{detail:e}=t;document.getElementById("js-online-status").classList.toggle("visible",!e)});const rt=document.getElementById("js-google-sign-in");let lt=null,ct=!1,dt=!1,ut=!1;async function mt(){try{if(!dt)return void await ft(!0);const t=gapi.auth2.getAuthInstance();t.isSignedIn.get()?(await t.signOut(),ct=!1,lt=null,document.getElementById("js-google-panel-toggle-btn").remove(),rt.insertAdjacentHTML("beforeend",'\n        <button id="js-google-sign-in-btn" class="btn btn-text"\n            data-item="google-sign-in" data-disable>Sign In</button>\n    '),Q(),d("google-sign-out")):(await t.signIn(),pt(t.currentUser.get()))}catch(t){console.log(t)}}async function ft(t){if(void 0===t&&(t=!1),dt||ut)return ct;ut=!0;try{await i.load({src:"https://apis.google.com/js/api.js"}),await new Promise(t=>gapi.load("client:auth2",t)),await gapi.client.init({apiKey:"AIzaSyD33Rxm4dA34Mh84oSxYTUUF_jyCLLOua4",clientId:"293076144560-r5cear7rprgo094u6ibcd6nl3bbg18te.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest"],scope:"https://www.googleapis.com/auth/youtube.force-ssl"});const e=gapi.auth2.getAuthInstance();return e.isSignedIn.get()?pt(e.currentUser.get()):t&&(await e.signIn(),pt(e.currentUser.get())),dt=!0,ct}catch(t){console.log(t)}finally{ut=!1}}function pt(t){const e=document.getElementById("js-google-sign-in-btn");ct=!0,function(t){const e=t.getBasicProfile();lt={name:e.getName(),email:e.getEmail(),image:e.getImageUrl()}}(t),e.remove(),rt.insertAdjacentHTML("afterbegin",`\n        <button id="js-google-panel-toggle-btn" class="btn btn-icon google-panel-toggle-btn"\n            data-disable>\n            <img src="${lt.image}" class="google-user-image" alt="">\n        </button>\n    `),document.getElementById("js-google-panel-toggle-btn").addEventListener("click",vt)}function yt(t,e){let{element:n}=e;n.insertAdjacentHTML("afterend",`\n        <div id=${t} class="panel google-panel">\n            <div class="google-user">\n                <img src="${lt.image}" class="google-user-image" alt="">\n                <div class="google-user-details">\n                    <div class="google-user-name">${lt.name}</div>\n                    <div>${lt.email}</div>\n                </div>\n            </div>\n            <button class="btn btn-text google-sign-out-btn"\n                data-item="google-sign-in">Sign Out</button>\n        </div>\n    `)}function vt(t){let{currentTarget:e}=t;et("js-google-panel",yt,{element:e})}n(120);function gt(){return document.getElementById("js-player-messages")||function(){const t=document.createElement("div");return t.id="js-player-messages",t.classList.add("player-messages"),document.getElementById("js-player").appendChild(t),t}()}function bt(){const t=gt();if(t){const e=[...t.children].reverse();for(const n of e)if(!n.id){n.remove(),e.length-1==0&&t.remove();break}}}function ht(t){let{title:e,body:n,id:i}=t;gt().insertAdjacentHTML("afterBegin",`\n        <div ${i?`id=${i} `:""}class="player-message">\n            ${e?`<h3 class="player-message-title">${e}</h3>`:""}\n            <div class="player-message-body">${n}</div>\n        </div>\n    `),i||setTimeout(bt,6e3)}function wt(){location.reload()}function kt(){d("connectivity-status",navigator.onLine)}window.addEventListener("sw-state-change",t=>{let{detail:e}=t;"update"===e&&(gt().insertAdjacentHTML("afterBegin",'\n        <div class="player-message service-worker-message">\n            <p class="player-message-body">Update is available, please refresh.</p>\n            <button id="js-player-message-btn" class="btn btn-icon player-message-btn">Refresh</button>\n        </div>\n    '),document.getElementById("js-player-message-btn").addEventListener("click",wt),setTimeout(bt,6e3))}),window.addEventListener("online",kt),window.addEventListener("offline",kt),window.addEventListener("load",kt);let Et=null;function Lt(t){ht({title:"YouTube",body:t})}function It(t){if(t.includes("H")||(t=`0H${t}`),!t.includes("M")){const e=t.indexOf("H")+1;t=`${t.slice(0,e)}0M${t.slice(e)}`}return t.includes("S")||(t=`${t}0`),t.match(/\d{1,}/g).reverse().reduce((t,e,n)=>t+=e*60**n,0)}function $t(t,e,n,i,o){const s=function(){const t=gapi.auth2.getAuthInstance();return t.isSignedIn.get()?t.currentUser.get().getAuthResponse().access_token:null}();let a=`part=${e}&${n}=${i}&maxResults=50&key=AIzaSyD33Rxm4dA34Mh84oSxYTUUF_jyCLLOua4`;return o&&(a+=`&pageToken=${o}`),s&&(a+=`&access_token=${s}`),fetch(`https://www.googleapis.com/youtube/v3/${t}?${a}`).then(t=>t.json())}function jt(t,e){return t.reduce((t,n)=>{return e.some(t=>t.id===n.id)||t.push(n),t},[])}function Tt(t){return t.filter(t=>{const e=t.snippet.title;return"Deleted video"!==e&&"Private video"!==e})}function xt(t){return t.map(t=>({id:t.snippet.resourceId.videoId,durationInSeconds:t.durationInSeconds,duration:c(t.durationInSeconds),name:t.snippet.title,title:t.snippet.title,artist:"",album:"",picture:t.snippet.thumbnails.medium.url,player:"youtube"}))}async function Bt(t,e){const{error:n,items:i,nextPageToken:o}=await $t("playlistItems","snippet","playlistId",t,e);n&&function(t){let{code:e,message:n}=t;throw 403===e?n="You need to be sign in if you want to import private playlists":404===e&&(n="Playlist was not found"),Lt(n),new Error(n)}(n);const s=xt(await async function(t){const e=t.map(t=>t.snippet.resourceId.videoId).join(),n=await $t("videos","contentDetails","id",e);return t.reduce((t,e)=>{const i=n.items.find(t=>{let{id:n}=t;return n===e.snippet.resourceId.videoId});return i&&(e.durationInSeconds=It(i.contentDetails.duration)-1,t.push(e)),t},[])}(Tt(i)));if(o){const e=await Bt(t,o);return s.concat(e)}return s}async function At(t){const{items:e}=await $t("playlists","snippet,status","id",t),n="private"===e[0].status.privacyStatus,i={title:e[0].snippet.title,isPrivate:n};return n&&(i.user=lt),i}function St(t,e){return S(t)||O(Object.assign({id:t,type:"grid",storePlaylist:!0},e))}async function Ot(t,e){const n=St(t,{title:"YouTube"}),{items:i}=await $t("videos","snippet,contentDetails","id",e);if(i.length){So(n,jt(xt(Tt(i).map(t=>(t.snippet.resourceId={videoId:t.id},t.durationInSeconds=It(t.contentDetails.duration)-1,t))),n.tracks))}else Lt("Video was not found")}async function Mt(t,e,n){const i=St(e,{url:t}),o=await Bt(e);"sync"===n&&function(t){let{id:e,_id:n,tracks:i}=t;const{rendered:o}=R(e),s=uo(e);o&&s&&(s.innerHTML="");Ro({action:"remove-tracks",playlist:{_id:n,tracks:i}}),i.length=0}(i),i.title||M(i.id,await At(e)),So(i,jt(o,i.tracks))}async function Rt(t,e){const{videoId:n,playlistId:i}=function(t){let e="",n="";try{const{searchParams:i}=new URL(t);e=i.get("v"),n=i.get("list")}catch(i){const o=t.match(/v=[a-zA-Z0-9\-_]+/),s=t.match(/list=[a-zA-Z0-9\-_]+/);o&&(e=o[0].slice(2)),s&&(n=s[0].slice(5))}return{videoId:e,playlistId:n}}(t),o=i||"youtube";if(n||i)if("WL"!==i){d("import",{importing:!0,option:"youtube",playlistId:o});try{n?await Ot(o,n):await Mt(t,o,e)}catch(t){console.log(t)}finally{d("import",{importing:!1,option:"youtube",playlistId:o})}}else Lt("Importing <b>Watch Later</b> playlist is not allowed");else Lt("Invalid url")}window.addEventListener("google-sign-out",()=>{Et=null});let Pt=null;function Ht(){const t="js-pl-entries";return document.getElementById(t)||function(t){document.getElementById("js-tab-home").insertAdjacentHTML("beforeend",`\n        <div class="home-tab-section pl-entry-container">\n            <div class="home-tab-section-header">\n                <h2 class="home-tab-section-title">Playlists</h2>\n            </div>\n            <ul id="${t}"></ul>\n        </div>\n    `);const e=document.getElementById(t);return e.addEventListener("click",Gt),e.addEventListener("focus",Zt,!0),e}(t)}function Ct(t){let{action:e,title:n,iconId:i,disabled:o}=t;return`\n        <button class="btn btn-icon pl-entry-btn" data-action="${e}"\n            title="${n}"${o?" disabled":""}>\n            ${p({iconId:i})}\n        </button>\n    `}function _t(t){let e=Math.floor(t/3600),n=Math.ceil(t/60%60);return 60===n&&(n=0,e+=1),`${e} hr ${n} min`}function Vt(t){const e=function(t){const e="assets/images/album-art-placeholder.png",n=[];if(!t.length)return[e];const i=f(t.map(t=>t.picture));for(const t of i){if(4===n.length)break;t!==e&&n.push(t)}if(!n.length)return[e];return n}(t);return`\n        <div class="pl-entry-thumbnail _${e.length}">\n            ${e.map(t=>`\n                <div class="pl-entry-thumb-image-container">\n                    <img src="${u(t)}" class="pl-entry-thumb-image" alt="">\n                </div>\n            `).join("")}\n        </div>\n    `}function qt(t,e){const n=H(e);t.querySelector(".track-count").textContent=`${e.length} tracks`,t.querySelector(".playlist-duration").textContent=_t(n)}function Ut(t,e){o(t.querySelector(".pl-entry-thumbnail")),t.insertAdjacentHTML("afterbegin",Vt(e))}function Dt(t,e){const{children:n}=document.getElementById("js-pl-entries");for(const i of n)if(t===i.getAttribute("data-entry-id")){qt(i,e),Ut(i,e);break}}function Wt(t,e){let{element:n,pl:i}=e;n.insertAdjacentHTML("afterend",`\n        <div id="${t}" class="panel pl-entry-panel">\n            <h3 class="panel-title">Playlist settings</h3>\n            <label class="pl-entry-setting">\n                <input type="checkbox" class="checkbox-input" ${i.syncOnInit?"checked":""}>\n                <div class="checkbox">\n                    <div class="checkbox-tick"></div>\n                </div>\n                <span>Synchronize playlist on startup</span>\n            </label>\n        </div>\n    `),document.getElementById(t).addEventListener("change",Qt)}function Nt(t){const{parentElement:e}=t;var n;o(t),e.children.length||((n=e).removeEventListener("click",Gt),n.removeEventListener("focus",Zt,!0),o(n.parentElement))}async function Yt(t){t.length&&(t.forEach(t=>{let{id:e}=t;d("import",{importing:!0,option:"youtube",playlistId:e})}),await ft(),t.forEach(t=>{let{url:e}=t;Rt(e,"sync")}))}function zt(t){let{currentTarget:e}=t;const{attrValue:n}=a("data-entry-id",e),i=S(n),o=e.value;var s;(e.removeEventListener("blur",zt),e.removeEventListener("keyup",Kt),o)?o!==i.title&&(i.title=o,s=o,it(n).querySelector(".sidebar-link").textContent=s,Ro({action:"change-title",playlist:{_id:i._id,title:o}})):e.value=i.title}function Kt(t){let{currentTarget:e,which:n}=t;13===n&&e.blur()}function Ft(t){document.getElementById("js-player").insertAdjacentHTML("beforeend",`\n        <div id="${t}" class="modal">\n            <div class="panel">\n                <div class="panel-title-container">\n                    ${p({iconId:"trash",className:"panel-icon"})}\n                    <h3 class="panel-title">Remove playlist?</h3>\n                </div>\n                <p>Are you sure you want to remove this playlist?<br>If you remove this playlist all your tracks will be lost.</p>\n                <div class="panel-button-container">\n                    <button class="btn btn-danger" data-type="remove">Remove</button>\n                    <button class="btn btn-text" data-type="cancel">Cancel</button>\n                </div>\n            </div>\n        </div>\n    `),document.getElementById(t).addEventListener("click",Jt)}function Xt(t){document.getElementById("js-player").insertAdjacentHTML("beforeend",`\n        <div id="${t}" class="modal">\n            <div class="panel">\n                <div class="panel-title-container">\n                    ${p({iconId:"sync",className:"panel-icon"})}\n                    <h3 class="panel-title">Syncronize playlist?</h3>\n                </div>\n                <p>Are you sure you want to synchronize this playlist with the playlist on YouTube? If you choose to synchronize you will lose all previously imported tracks.</p>\n                <div class="panel-button-container">\n                    <button class="btn btn-danger" data-type="sync">Synchronize</button>\n                    <button class="btn btn-text" data-type="cancel">Cancel</button>\n                </div>\n            </div>\n        </div>\n    `),document.getElementById(t).addEventListener("click",Jt)}function Jt(t){let{target:e,currentTarget:n}=t;if(e===n)return Q(),void(Pt=null);const i=a("data-type",e);i&&("remove"===i.attrValue?(Ao(Pt.playlist),Nt(Pt.entryElement)):"sync"===i.attrValue&&Yt([Pt.playlist]),Q(),Pt=null)}function Gt(t){let{target:e}=t;const n=a("data-entry-id",e),i=a("data-action",e);if(!n||!i||i.elementRef.disabled)return;const{attrValue:o,elementRef:s}=i,r=S(n.attrValue);"remove"===o?r.tracks.length?(Pt={playlist:r,entryElement:n.elementRef},et("js-pl-remove-panel",Ft)):(Ao(r),Nt(n.elementRef)):"sync"===o?(Pt={playlist:r},et("js-pl-sync-panel",Xt)):"settings"===o?et("js-pl-entry-panel",Wt,{element:s,pl:r}):"edit"===o&&s.querySelector(".input").focus()}function Zt(t){let{target:e}=t;const n=a("data-action",e);n&&"edit"===n.attrValue&&(e.addEventListener("blur",zt),e.addEventListener("keyup",Kt))}function Qt(t){let{target:e}=t;const{attrValue:n}=a("data-entry-id",e),i=S(n);i.syncOnInit=e.checked,Ro({action:"change-sync",playlist:{_id:i._id,syncOnInit:i.syncOnInit}})}function te(t){let{currentTarget:e,target:n}=t;const i=a("data-panel-item",n,e);if(!i)return;const{attrValue:s,elementRef:r}=i;"btn"===s?(!function(t,e,n,i){e.insertAdjacentHTML(n,`\n        <form id="js-${t}-form" class="${t}-form">\n            <input type="text" name="title" class="input" autocomplete="off" placeholder="Title" required>\n            <button class="btn">Create</button>\n        </form>\n    `);const o=document.getElementById(`js-${t}-form`);o.elements.title.focus(),o.addEventListener("submit",i)}("move-to",r.parentElement,"beforeend",ee),o(r)):(e.removeEventListener("click",te),function(t){const e=Oe(Se()),{tracks:n}=no(),i=S(t),o=n.filter(n=>e.includes(n.index)&&!W(t,n.name));So(i,o),E(`playlist/${i.id}`)}(s),Q(),be())}function ee(t){const e=document.getElementById("js-move-to-list"),n=eo();Oo(t),e?e.innerHTML=ne(n):t.target.insertAdjacentHTML("beforebegin",ie(n))}function ne(t){return A().reduce((e,n)=>(n.id!==t&&(e+=`\n                <li data-panel-item="${n.id}">\n                    <button class="btn btn-icon move-to-list-item-btn">${n.title}</button>\n                </li>\n            `),e),"")}function ie(t){const e=ne(t);return e?`<ul id="js-move-to-list" class="move-to-list">${e}</ul>`:""}function oe(t,e){let{playlistId:n}=e;document.getElementById("js-move-to-panel-container").insertAdjacentHTML("beforeend",`\n        <div id="${t}" class="panel move-to-panel">\n            <h3 class="panel-title move-to-panel-title">Move to</h3>\n            ${ie(n)}\n            <button class="btn btn-icon move-to-new-pl-btn" data-panel-item="btn">\n                ${p({iconId:"plus"})}\n                <span>Create new playlist</span>\n            </button>\n        </div>\n    `)}window.addEventListener("connectivity-status",t=>{let{detail:e}=t;const n=document.getElementById("js-pl-entries");if(n){n.querySelectorAll("[data-action=sync]").forEach(t=>{t.disabled=!e})}});const se={},ae={};let re=null,le=null,ce=null,de={},ue=[],me=0,fe=!1,pe=!1;function ye(t){let{id:e,tracks:n}=t;re&&ve(),n.length&&(re=io(e),re.addEventListener("mousedown",Be))}function ve(){re.removeEventListener("mousedown",Be),re=null}function ge(){Se().forEach(t=>{t.classList.remove("selected")})}function be(){ge(),we()}function he(){pe||(pe=!0,function(){const t="js-move-to-panel-container";document.getElementById("js-playlist-tab-header-items").insertAdjacentHTML("afterbegin",`\n        <div id="${t}" class="playlist-tab-header-item" data-move-to>\n            <button class="btn btn-icon" data-item="move-to" title="Move to">\n                ${p({iconId:"move-to"})}\n            </button>\n        </div>\n    `),document.getElementById(t).addEventListener("click",te)}(),setTimeout(()=>{window.addEventListener("click",xe,!0)},0),window.addEventListener("keydown",Ae))}function we(){pe&&(pe=!1,function(){const t=document.getElementById("js-move-to-panel-container");t.removeEventListener("click",te),o(t)}(),window.removeEventListener("click",xe,!0),window.removeEventListener("keydown",Ae))}function ke(t,e){return t>e?e:t<0?0:t}function Ee(){clearInterval(me),me=0}function Le(t){fe=!0,requestAnimationFrame(()=>{ce&&function(t,e,n,i){let o=t.x-e.x,s=t.y-e.y;if(o<0){const t=e.x+o;o*=-1,n.left=t,i.left=`${t}px`}else n.left!==e.x&&(n.left=e.x,i.left=`${e.x}px`);if(s<0){const t=e.y+s;s*=-1,n.top=t,i.top=`${t}px`}else n.top!==e.y&&(n.top=e.y,i.top=`${e.y}px`);n.right=n.left+o,n.bottom=n.top+s,i.width=`${o}px`,i.height=`${s}px`}(ae,se,de,ce.style),function(t,e,n){for(let i=0;i<t.length;i++){const o=t[i],s=o.ref.classList;e.right>o.left&&e.left<o.right&&e.bottom>o.top&&e.top<o.bottom?(n&&!o.selected&&s.contains("selected")&&(s.remove("selected"),o.removed=!0),o.removed||(s.add("selected"),o.selected=!0)):o.selected?(s.remove("selected"),o.selected=!1):o.removed&&(s.add("selected"),o.removed=!1)}}(ue,de,t),fe=!1})}function Ie(t,e,n){let{scrollHeight:i,height:o}=n;e.scrollTop+=36,ae.y=e.scrollTop+o,ae.y>=i&&(ae.y=i,Ee()),fe||Le(t)}function $e(t,e){e.scrollTop-=36,ae.y=e.scrollTop,ae.y<=0&&(ae.y=0,Ee()),fe||Le(t)}function je(t){const{top:e,left:n,width:i,height:o,scrollHeight:s}=le,a=t.clientY-e;if(ae.x=ke(t.clientX-n,i),ae.y=ke(re.scrollTop+a,s),t.preventDefault(),!ce&&function(t,e){return t.x>e.x+2||t.x<e.x-2||t.y>e.y+2||t.y<e.y-2}(ae,se))return ue=function(){const{children:t}=uo(eo());return Array.from(t).map(t=>{const e=t.offsetTop,n=t.offsetLeft;return{ref:t,top:e,left:n,right:n+t.offsetWidth,bottom:e+t.offsetHeight}})}(),ce=function(t,e){let{x:n,y:i}=e;return de.top=i,de.left=n,t.insertAdjacentHTML("afterbegin",`\n        <div class="selection-area" style="top: ${i}px; left: ${n}px"></div>\n    `),t.firstElementChild}(re,se),document.activeElement.blur(),t.ctrlKey||ge(),void we();if(fe||Le(t.ctrlKey),me&&a>0&&a<o)Ee();else if(!me){let e=null;if(a>o&&ae.y<s)e=Ie;else{if(!(a<0&&ae.y>0))return;e=$e}me=setInterval(e,40,t.ctrlKey,re,le)}}function Te(t){let{target:e,ctrlKey:n}=t;if(me&&Ee(),ce){const t=Se();o(ce),ce=null,de={},ue.length=0,t.length?he():we()}else{const t=a("data-index",e,re);t?function(t,e){if(e||ge(),t.classList.toggle("selected"),t.classList.contains("selected"))he();else{const e=Se();t.blur(),e.length||we()}}(t.elementRef,n):n||be()}window.removeEventListener("mousemove",je),window.removeEventListener("mouseup",Te)}function xe(t){let{target:e}=t;!a("data-move-to",e)&&r(e,re)&&be()}function Be(t){let{currentTarget:e,target:n,which:i,clientX:o,clientY:s}=t;var r;1===i&&(a("data-btn",n)?be():(le={top:(r=e).offsetTop,left:r.offsetLeft,width:r.clientWidth,height:r.offsetHeight,scrollHeight:r.scrollHeight},se.x=o-le.left,se.y=e.scrollTop+s-le.top,se.x<le.width&&(window.addEventListener("mousemove",je),window.addEventListener("mouseup",Te))))}function Ae(t){let{key:e,keyCode:n}=t;"Delete"!==e&&127!==n||(!function(){const t=Se(),e=no(),n=Oe(t),{tracksToKeep:i,tracksToRemove:s}=function(t,e){const n=[],i=[];return t.forEach(t=>{e.includes(t.index)?i.push(t):n.push(t)}),{tracksToRemove:i,tracksToKeep:n}}(e.tracks,n);e.tracks=i,function(t){t.forEach(o)}(t),X(e),G(e),function(t){const{sortOrder:e}=R(t);[...uo(t).children].forEach((t,n)=>{const i=t.querySelector(".list-item-index");i&&(i.textContent=n+1),t.setAttribute("data-index",e[n])})}(e.id),K(e.id,g("shuffle")),D(e.id),Dt(e.id,i),i.length||(ve(),wo(e));Ro({action:"remove-tracks",playlist:{_id:e._id,tracks:s}})}(),we())}function Se(){return Array.from(re.querySelectorAll(".track.selected"))}function Oe(t){return t.map(t=>parseInt(t.getAttribute("data-index"),10))}n(121);const Me=document.getElementById("js-filter-input"),Re=Me.parentElement;let Pe=0,He="";function Ce(t,e,n,i){const o=new RegExp(i,"i"),{sortOrder:s}=R(t);e.forEach(t=>{const e=n[s.indexOf(t.index)],i=`${t.title}\n${t.artist}\n${t.album}`;e.classList.toggle("hidden",!o.test(i))})}function _e(t,e){void 0===e&&(e="");const{tracks:n}=S(t);if(!n.length)return;const{children:i}=uo(t);var o;He=e?t:"",Ce(t,n,i,e),o=e,document.getElementById("js-clear-input-btn").classList.toggle("visible",o)}function Ve(){He&&(Me.value="",_e(He))}function qe(){Re.classList.remove("active"),Me.removeEventListener("keyup",Ue),Me.removeEventListener("blur",qe)}function Ue(t){let{target:e}=t;const n=eo();clearTimeout(Pe),Pe=setTimeout(_e,400,n,e.value)}function De(t){document.getElementById("js-order-toggle").querySelector("use").setAttribute("href",`#${1===t?"down":"up"}-arrow`)}function We(t,e){const{value:n}=document.getElementById("js-filter-input");if(t.order=t.sortedBy===e&&1===t.order?-1:1,t.sortedBy=e,G(t),Ro({action:"change-sorting",playlist:{order:t.order,_id:t._id,sortedBy:e}}),D(t.id),wo(t),n){const{children:e}=uo(t.id);Ce(t.id,t.tracks,e,n)}}function Ne(t){let{sortedBy:e,order:n}=t;var i;i=e,document.getElementById("js-sort-toggle").textContent=i,De(n)}function Ye(t,e){let{sortedBy:n}=e;document.getElementById("js-sort-panel-container").insertAdjacentHTML("beforeend",function(t,e){return`<ul id="${t}" class="panel sort-panel">${function(t){return["index","title","artist","album","duration"].reduce((e,n)=>{return`\n            ${e}\n            <li>\n                <button class="btn btn-icon sort-option-btn${n===t?" active":""}" data-sort="${n}">\n                    ${n}\n                </button>\n            </li>\n        `},"")}(e)}</ul>`}(t,n)),document.getElementById(t).addEventListener("click",ze)}function ze(t){let{currentTarget:e,target:n}=t;const i=n.getAttribute("data-sort"),o=no();e.removeEventListener("click",ze),Q(),i!==o.sortedBy&&(Ne({sortedBy:i,order:1}),We(o,i))}Me.addEventListener("focus",t=>{let{currentTarget:e}=t;Re.classList.add("active"),e.addEventListener("keyup",Ue),e.addEventListener("blur",qe)}),Re.addEventListener("click",t=>{let{target:e}=t;const n=a("data-filter-item",e);if(!n)return;const i=n.attrValue;"icon"===i?Me.focus():"button"===i&&(Ve(),qe())});const Ke=document.getElementById("js-volume-slider"),Fe=document.getElementById("js-track-slider"),Xe=document.getElementById("js-controls");let Je=!1,Ge=null;const Ze=function(){let t=0;function e(){clearTimeout(t)}function n(e,i,o){const s=performance.now()-i-o;Je||mn(e,e.currentTime),Pi.updateTrack({currentTime:e.currentTime}),e.currentTime<=e.durationInSeconds?(e.currentTime+=1,o+=1e3,t=setTimeout(n,1e3-s,e,i,o)):d("track-end")}return{stop:e,start:function(t){const i=performance.now();e(),n(t,i,0)}}}();function Qe(){const t=mo();t&&(Ge=t,t.classList.add("show-spinner")),document.getElementById("js-play-btn").classList.add("show-spinner")}function tn(){const t=mo();Ge&&(Ge.classList.remove("show-spinner"),Ge=null),t&&t.classList.remove("show-spinner"),document.getElementById("js-play-btn").classList.remove("show-spinner")}function en(t){return t?{id:"play",title:"Play"}:{id:"pause",title:"Pause"}}function nn(t,e){m(t,en(e))}function on(t,e){const n={on:{id:"volume-off",title:"Unmute"},off:{id:"volume",title:"Mute"}};m(t,e?n.on:n.off)}function sn(t,e){const{left:n,width:i}=document.getElementById(`js-${t}-slider`).getBoundingClientRect();let o=(e-n)/i*100;return o<0?o=0:o>100&&(o=100),o}function an(){Ze.stop(),mn()}function rn(t){v("volume",t),fn(t),function(t){const e=U()||{};"native"===e.player?bi(t):"youtube"===e.player&&Mi(t)}(t)}function ln(t,e){const n=e/2;return t+n+8>window.innerWidth||t-n-8<0}function cn(t,e){return`calc(${t}% - ${e}px)`}function dn(t,e){const n=document.getElementById("js-volume-slider-label");n.textContent=`${Math.floor(t)}%`;const i=n.offsetWidth;ln(e,i)||(n.style.left=cn(t,i/2))}function un(t,e){document.getElementById(`js-${t}-slider-thumb`).style.left=`${100*e}%`,document.getElementById(`js-${t}-slider-elapsed`).style.transform=`scaleX(${e})`}function mn(t,e){void 0===e&&(e=0);let n=1,i="0:00";t&&(n=t.durationInSeconds,i=t.duration);const o=c(e,n>=3600);Je||(document.getElementById("js-track-current").textContent=o),un("track",e/n),Fe.setAttribute("aria-valuenow",e),Fe.setAttribute("aria-valuetext",`${o} of ${i}`)}function fn(t){const e=Math.floor(100*t);un("volume",t),Ke.setAttribute("aria-valuenow",e),Ke.setAttribute("aria-valuetext",`${e}% volume`)}function pn(t,e){void 0===t&&(t="0:00"),void 0===e&&(e=0),document.getElementById("js-track-duration").textContent=t,Fe.setAttribute("aria-valuemax",e)}function yn(t,e){const n=sn("track",t);return{percent:n,currentTime:Math.floor(e*n/100)}}function vn(t,e,n){const i=document.getElementById("js-track-slider-label");i.textContent=c(e);const o=i.offsetWidth;ln(n,o)||(i.style.left=cn(t,o/2))}function gn(t){let{pageX:e}=t;const n=U(),{percent:i,currentTime:o}=yn(e,n.durationInSeconds);mn(n,o),vn(i,o,e)}function bn(t){let{pageX:e}=t;const n=U();if(!n)return;const{percent:i,currentTime:o}=yn(e,n.durationInSeconds);vn(i,o,e)}function hn(t){let{pageX:e}=t;const n=U();if(Je=!1,n){const{currentTime:t}=yn(e,n.durationInSeconds);mn(n,t),Ji(n.player,t),Pi.updateTrack({currentTime:t})}window.removeEventListener("pointermove",gn),window.removeEventListener("pointerup",hn),Fe.addEventListener("pointermove",bn)}function wn(t){let{pageX:e}=t;const n=sn("volume",e),i=n/100;i!==g("volume")&&(dn(n,e),i?(Tn(),rn(i)):$n({attrValue:"mute",elementRef:document.getElementById("js-volume-btn")}))}function kn(t){let{pageX:e}=t;dn(sn("volume",e),e)}function En(){window.removeEventListener("pointermove",wn),window.removeEventListener("pointerup",En),Ke.addEventListener("pointermove",kn)}let Ln=0;function In(t,e){let n=t.getAttribute("data-mode");const i={normal:{name:"repeat",nextTitle:"Play track once",currentTitle:"Repeat track",iconId:"repeat"},repeat:{name:"track-once",nextTitle:"Play playlist once",currentTitle:"Play track once",iconId:"repeat-once"},"track-once":{name:"playlist-once",nextTitle:"Repeat playlist",currentTitle:"Play playlist once",iconId:"repeat-once"},"playlist-once":{name:"normal",nextTitle:"Repeat track",currentTitle:"Repeat playlist",iconId:"repeat"}};if(e){for(const[t,o]of Object.entries(i))if(e===o.name){n=t;break}}else{const e=document.getElementById("js-control-btn-label");e&&e.remove(),t.parentElement.insertAdjacentHTML("afterbegin",`\n            <div id="js-control-btn-label" class="control-btn-label">${i[n].currentTitle}</div>\n        `),clearTimeout(Ln),Ln=setTimeout(()=>{document.getElementById("js-control-btn-label").remove()},1e3)}const{name:o,nextTitle:s,iconId:a}=i[n];"normal"===o?(t.classList.remove("active"),t.setAttribute("aria-checked",!1)):(t.setAttribute("aria-checked",!0),t.classList.add("active")),t.setAttribute("data-mode",o),t.setAttribute("title",s),t.querySelector("use").setAttribute("href",`#${a}`),v("playback",o)}function $n(t){let{attrValue:e,elementRef:n}=t;if("playback"===e)return void In(n);const i=!g(e);n.setAttribute("aria-checked",i),v(e,i),"mute"===e?(jn(i),on(n,i)):n.classList.toggle("active")}function jn(t){const e=t?0:g("volumeBeforeMute");t?v("volumeBeforeMute",g("volume")):b("volumeBeforeMute"),rn(e)}function Tn(){const t=g("mute");if(t){const e=document.getElementById("js-volume-btn");b("volumeBeforeMute"),v("mute",!t),on(e,!t),e.classList.remove("active")}}function xn(t){let e=g("volume");if(e<1&&"ArrowUp"===t)e||Tn(),e+=.05,e>1&&(e=1);else if(e&&"ArrowDown"===t&&(e-=.05,e<=0))return e=0,void $n({attrValue:"mute",elementRef:document.getElementById("js-volume-btn")});rn(e)}function Bn(t){const e=U();if(!e)return;const n=e.durationInSeconds;let{currentTime:i}=Pi.getTrack();"ArrowRight"===t||"ArrowUp"===t?(i+=5,i>n&&(i=n)):"ArrowLeft"!==t&&"ArrowDown"!==t||(i-=5,i<0&&(i=0)),mn(e,i),Ji(e.player,i),Pi.updateTrack({currentTime:i})}function An(t){return function(e){let{pageX:n}=e;const i=document.getElementById(`js-${t}-slider-label`),o=window.innerWidth,s=i.offsetWidth/2;if(n+s+8>o){const e=sn(t,o-s-8);i.style.left=cn(e,s)}else if(n-s-8<0){const e=sn(t,s+8);i.style.left=cn(e,s)}}}window.addEventListener("keydown",t=>{const e=t.ctrlKey||t.shiftKey||t.altKey||t.metaKey;if(t.target instanceof HTMLInputElement||e)return;const{key:n}=t;"p"===n?Di():"m"===n?function(){const t=!g("mute"),e=document.getElementById("js-volume-btn");jn(t),on(e,t),v("mute",t)}():"["===n?Ni():"o"===n?Yi():n.startsWith("Arrow")&&"slider"!==t.target.getAttribute("role")&&!function t(e){if(e)return e.scrollHeight>e.clientHeight?e:t(e.parentElement)}(t.target)&&("ArrowUp"===n||"ArrowDown"===n?xn(n):"ArrowRight"!==n&&"ArrowLeft"!==n||Bn(n))}),Fe.addEventListener("pointerdown",t=>{1===t.which&&U()&&(Je=!0,gn(t),Fe.removeEventListener("pointermove",bn),window.addEventListener("pointermove",gn),window.addEventListener("pointerup",hn))}),Fe.addEventListener("pointermove",bn),Fe.addEventListener("pointerenter",An("track")),Fe.addEventListener("keydown",t=>{let{key:e}=t;e.startsWith("Arrow")&&Bn(e)}),Ke.addEventListener("pointerdown",t=>{1===t.which&&(wn(t),Ke.removeEventListener("pointermove",kn),window.addEventListener("pointermove",wn),window.addEventListener("pointerup",En))}),Ke.addEventListener("pointermove",kn),Ke.addEventListener("pointerenter",An("volume")),Ke.addEventListener("keydown",t=>{let{key:e}=t;e.startsWith("Arrow")&&xn(e)}),document.getElementById("js-main-controls").addEventListener("click",t=>{let{target:e}=t;const n=a("data-item",e);if(n)switch(n.attrValue){case"previous":Yi();break;case"play":Di();break;case"next":Ni()}}),Xe.addEventListener("click",t=>{let{target:e}=t;const n=a("data-item",e);n&&$n(n)}),Xe.addEventListener("keyup",t=>{let{which:e,target:n}=t;const i=a("data-item",n);!i||32!==e&&13!==e||$n(i)}),document.getElementById("js-control-toggle-btn").addEventListener("click",()=>{Xe.classList.toggle("visible")}),fn(g("volume")),Array.from(document.querySelectorAll(".control-btn")).forEach(t=>{const e=t.getAttribute("data-item"),n=g(e);if(n){if("playback"===e)return void In(t,n);t.setAttribute("aria-checked",!0),"mute"===e?on(t,n):t.classList.add("active")}});const Sn=document.getElementById("js-now-playing"),On=document.getElementById("js-jump-to-track-btn"),Mn=document.getElementById("js-media-toggle-btn"),Rn=document.getElementById("js-media-container");let Pn=null,Hn=!1;function Cn(t){let{target:e}=t;const n=a("data-item",e);n&&"image"===n.attrValue&&qi(U())}function _n(){const t=document.activeElement;t instanceof HTMLIFrameElement&&requestAnimationFrame(()=>{t.blur()})}function Vn(t){27===t.which&&(Hn=!1,Rn.classList.remove("visible"),window.removeEventListener("keydown",Vn),m(Mn,{title:"Expand",id:"expand"}))}function qn(){const t=document.getElementById("js-track-info");t&&o(t)}function Un(t){void 0===t&&(t="./assets/images/album-art-placeholder.png"),document.getElementById("js-artwork").src=t}function Dn(t,e){Un(),qn(),function(t,e){Un(e),Sn.classList.remove("inactive"),On.insertAdjacentHTML("beforebegin",function(t,e){let n=t.name,i=t.name;t.artist&&t.title&&(n=`${t.artist} - ${t.title}${t.album?` - ${t.album}`:""}`,i=`\n            <div class="track-title">${t.title}</div>\n            <div class="track-artist">${t.artist}${t.album?` - ${t.album}`:""}</div>\n        `);return`<div id="${e}" class="track-info" title="${n}">${i}</div> `}(t,"js-track-info"))}(t,e)}function Wn(t){Pn&&URL.revokeObjectURL(Pn),Pn=u(t.picture),Dn(t,Pn),function(t,e){const n=document.getElementById("js-media-image-container");if("native"===t){const[t,i]=n.children;n.classList.remove("hidden"),i.src=e,t.style.backgroundImage=`url(${e})`}else n.classList.add("hidden")}(t.player,Pn)}function Nn(){document.title="Veery",Un(),qn(),Sn.classList.add("inactive"),Rn.classList.remove("visible"),Pn&&(URL.revokeObjectURL(Pn),Pn=null)}On.addEventListener("click",(function(){const t=_();t&&(t!==eo()?E(`playlist/${t}`):Io(t))})),Mn.addEventListener("click",(function(t){let{currentTarget:e}=t;const n=document.getElementById("js-yt-player");Rn.classList.toggle("visible"),Hn=!Hn,Hn?(Rn.addEventListener("click",Cn),window.addEventListener("keydown",Vn),window.addEventListener("blur",_n),m(e,{title:"Collapse",id:"collapse"}),n.removeAttribute("tabindex")):(Rn.removeEventListener("click",Cn),window.removeEventListener("keydown",Vn),window.removeEventListener("blur",_n),m(e,{title:"Expand",id:"expand"}),n.setAttribute("tabindex","-1"))}));n(123),n(126),n(127);var Yn=n(32);async function zn(t,e){void 0===e&&(e=[]);const n=t[e.length],i=await(o=n.audioTrack.link,fetch(o).then(t=>t.blob()));var o;const{duration:s}=await Object(Yn.a)(i);return e.push({audioTrack:i,durationInSeconds:s,title:n.name,artist:"",album:"",name:n.name,duration:c(s),picture:"assets/images/album-art-placeholder.png",player:"native"}),e.length===t.length?e:zn(t,e)}document.getElementById("js-dropbox-option").addEventListener("mouseenter",(function t(e){let{currentTarget:n}=e;i.load({src:"https://www.dropbox.com/static/api/2/dropins.js",id:"dropboxjs","data-app-key":"6ur73hspbv8o1z9"}),n.removeEventListener("mouseenter",t)}));const Kn=document.getElementById("js-import-options"),Fn=function(){const t=Object.assign({},{"local-files":{storePlaylist:!1},dropbox:{storePlaylist:!1}},{},JSON.parse(localStorage.getItem("import-settings")));return{setSetting:function(e,n,i){t[e][n]=i,localStorage.setItem("import-settings",JSON.stringify(t))},getSetting:function(e,n){return t[e]?t[e][n]:null},getSettings:function(){return t}}}();function Xn(t,e){let{children:n}=t;Array.from(n).forEach(t=>{let n=null;t.hasAttribute("data-item")?n=t:t.querySelector("[data-item]")&&(n=t.querySelector("[data-item]")),n&&(n.classList.toggle("spinner",e),n.disabled=e)})}function Jn(t,e){const n=it(t),i=function(t){const e=document.querySelector(`[data-entry-id="${t}"]`);return e?e.querySelector("[data-action='sync']"):null}(t);n&&n.classList.toggle("show-spinner",e),i&&(i.disabled=e,i.classList.toggle("spinner",e))}function Gn(t){document.getElementById("js-import-form").removeEventListener("submit",ni),t.removeEventListener("click",Zn),t.remove()}function Zn(t){let{target:e,currentTarget:n}=t;if(e===n||a("data-cancel-btn",e,n))return void Gn(n);const i=a("data-id",e,n);if(i)return Rt(`https://youtube.com/playlist?list=${i.attrValue}`),void Gn(n);const o=a("data-info-btn",e,n);if(o){const{elementRef:t}=o;et("js-youtube-info-panel",ii,{element:t})}}function Qn(){const t=function(){const t=Et;if(!t)return"";return`\n        <h4 class="youtube-modal-section-title">Your Playlists</h4>\n        <ul class="youtube-modal-playlists">${t.reduce((t,e)=>`\n            ${t}\n            <li class="youtube-modal-playlist">\n                <div class="youtube-modal-playlist-thumb-container">\n                    <img src="${e.thumbnail}" alt="" class="youtube-modal-playlist-thumb">\n                </div>\n                <div class="youtube-modal-playlist-content">\n                    <div>${e.title}</div>\n                    <div class="youtube-modal-playlist-info">${e.itemCount} item${1===e.itemCount?"":"s"}</div>\n                </div>\n                <button class="btn btn-text youtube-modal-playlist-import-btn" data-id="${e.id}">Import</button>\n            </li>\n        `,"")}</ul>\n    `}();Kn.insertAdjacentHTML("beforeend",`\n        <div id="js-youtube-modal" class="youtube-modal-container">\n            <div class="youtube-modal">\n                <h3 class="youtube-modal-title">YouTube Import</h3>\n                <form id="js-import-form" class="youtube-modal-form">\n                    <div class="youtube-modal-form-input-container">\n                        <input type="text" name="url" class="input youtube-modal-form-input" placeholder="URL" required>\n                        <button type="button"\n                            class="btn btn-icon youtube-modal-form-info-btn" data-info-btn>\n                            <svg viewBox="0 0 24 24">\n                                <use href="#info"></use>\n                            </svg>\n                        </button>\n                    </div>\n                    <button class="btn youtube-modal-form-submit-btn">Import</button>\n                </form>\n                ${t}\n                <div class="youtube-modal-footer">\n                    <button class="btn btn-text" data-cancel-btn>Cancel</button>\n                </div>\n            </div>\n        </div>\n    `),document.getElementById("js-youtube-modal").addEventListener("click",Zn),document.getElementById("js-import-form").addEventListener("submit",ni)}function ti(t){let{target:e}=t;mi([...e.files]),e.value="",e.removeEventListener("change",ti),e.remove()}function ei(t){const e=document.getElementById("js-file-picker")||function(){const t=document.createElement("input");return t.setAttribute("type","file"),t.setAttribute("id","js-file-picker"),t.setAttribute("accept","audio/*"),t.classList.add("file-picker"),t.addEventListener("change",ti),document.body.appendChild(t),t}();"file"===t?(e.removeAttribute("webkitdirectory"),e.removeAttribute("directory"),e.removeAttribute("allowdirs"),e.setAttribute("multiple","")):"folder"===t&&(e.removeAttribute("multiple"),e.setAttribute("webkitdirectory",""),e.setAttribute("directory",""),e.setAttribute("allowdirs","")),e.click()}function ni(t){const e=t.target.elements.url.value.trim();e&&(Rt(e),Gn(document.getElementById("js-youtube-modal"))),t.preventDefault()}function ii(t,e){let{element:n}=e;n.insertAdjacentHTML("afterend",`\n        <div id="${t}" class="panel info-panel">\n            <h3 class="panel-title">Accepted formats:</h3>\n            <ul>\n                <li class="info-panel-content-item">youtube.com/playlist?list={playlistId}</li>\n                <li class="info-panel-content-item">youtube.com/watch?v={videoId}</li>\n            </ul>\n        </div>\n    `)}function oi(t,e){let{element:n}=e;const i=Fn.getSettings();n.insertAdjacentHTML("afterend",`\n        <div id="${t}" class="panel import-settings-panel">\n            <h3 class="panel-title">Settings</h3>\n            <label class="import-setting">\n                <input type="checkbox" class="checkbox-input"\n                    ${i["local-files"].storePlaylist?"checked":""} data-id="local-files">\n                <div class="checkbox">\n                    <div class="checkbox-tick"></div>\n                </div>\n                <span class="import-setting-label">Store <b>Local files</b> playlist</span>\n            </label>\n            <label class="import-setting">\n                <input type="checkbox" class="checkbox-input"\n                    ${i.dropbox.storePlaylist?"checked":""} data-id="dropbox">\n                <div class="checkbox">\n                    <div class="checkbox-tick"></div>\n                </div>\n                <span class="import-setting-label">Store <b>Dropbox</b> playlist</span>\n            </label>\n            <div class="import-setting-message">\n                <svg viewBox="0 0 24 24">\n                    <use href="#info"></use>\n                </svg>\n                <span>Stored playlists will persist through reload</span>\n            </div>\n        </div>\n    `),document.getElementById(t).addEventListener("change",si)}function si(t){let{target:e}=t;const n=e.getAttribute("data-id");Fn.setSetting(n,"storePlaylist",e.checked)}async function ai(t,e){Xn(e,!0),"modal-toggle"===t?(await async function(){var t;if(await ft()&&!Et)try{const e=await $t("playlists","snippet,contentDetails","mine",!0);t=e.items,Et=t.map(t=>({id:t.id,itemCount:t.contentDetails.itemCount,title:t.snippet.title,thumbnail:t.snippet.thumbnails.medium.url}))}catch(t){console.log(t)}}(),Qn()):"google-sign-in"===t&&await mt(),Xn(e,!1)}Kn.addEventListener("click",t=>{let{currenTarget:e,target:n}=t;const i=a("data-item",n,e);if(!i||i.elementRef.disabled)return;const{attrValue:o,elementRef:s}=a("data-option",n,e);"local"===o?ei(i.attrValue):"dropbox"===o?Dropbox.choose({success(t){const e="dropbox";ci(e,S(e)||O({id:e,title:"Dropbox",type:"grid",storePlaylist:Fn.getSetting(e,"storePlaylist")}),t,zn)},linkType:"direct",multiselect:!0,extensions:["audio"]}):"youtube"===o&&ai(i.attrValue,s)}),document.getElementById("js-import-settings-btn").addEventListener("click",t=>{let{currentTarget:e}=t;et("js-import-settings-panel",oi,{element:e})}),window.addEventListener("import",t=>{let{detail:e}=t;const{importing:n,option:i,playlistId:o}=e;Xn(document.querySelector(`[data-option=${i}]`),n),Jn(o,n)}),window.addEventListener("connectivity-status",t=>{let{detail:e}=t;if(!e){const t=document.getElementById("js-youtube-modal");t&&Gn(t)}Kn.querySelectorAll("[data-disable]").forEach(t=>{t.disabled=!e})});const ri="assets/images/album-art-placeholder.png";function li(t){return t.map(t=>({needsMetadata:!0,audioTrack:t.audioTrack,name:t.name,title:t.name,artist:"",album:"",picture:ri,durationInSeconds:0,duration:"",player:"native"}))}async function ci(t,e,n,i){if(!n.length)return void ht({title:`${t} files`,body:"No valid audio file found"});const o=(s=n,a=e.tracks,s.reduce((t,e)=>{const n=function(t){return t.slice(0,t.lastIndexOf("."))}(e.name.trim());return a.some(t=>t.name===n)||t.push({audioTrack:e,name:n}),t},[]));var s,a;if(o.length){d("import",{importing:!0,option:t,playlistId:e.id});try{So(e,await i(o)),requestIdleCallback&&requestIdleCallback(ui)}catch(t){console.log(t)}finally{d("import",{importing:!1,option:t,playlistId:e.id})}}else ht({title:`${t} files`,body:`Track${n.length>1?"s":""} already exist`})}async function di(t){const{artist:e,title:n,album:i,duration:o,picture:s}=await Object(Yn.a)(t.audioTrack);t.title=n||t.name,t.artist=e||"",t.album=i||"",t.durationInSeconds=o,t.picture=s||ri,t.duration=c(o),await async function(t){const e=t.picture===ri;if(!t.album||e)try{const n="https://ws.audioscrobbler.com/2.0/",i=`?method=track.getInfo&api_key=${"3e8d48b3277c21bc77965345f5faf18c"}&artist=${t.artist}&track=${t.title}&format=json`,o=await fetch(n+i).then(t=>t.json());if(o.track&&o.track.album){const{title:n,image:i}=o.track.album;if(!t.album&&n&&(t.album=n),e&&i){const e=i[i.length-1]["#text"];if(e){const{origin:n,pathname:i}=new URL(e),[o]=i.split("/").slice(-1);t.picture=`${n}/i/u/${o}`}}}}catch(t){console.log(t)}}(t)}async function ui(){const t=S("local-files");if(!t)return;const e=t.tracks.find(t=>t.needsMetadata),{_id:n,id:i,tracks:o,type:s}=t;if(!e)return Dt(i,o),void Ro({action:"update-tracks",playlist:{_id:n,tracks:o}});try{if(await di(e),i===eo()){const t=ko(e.index,i),n=U();t&&(t.innerHTML=po(e,i,s)),n&&n.name===e.name&&Wn(e)}}catch(t){console.log(t)}finally{delete e.needsMetadata,requestIdleCallback(ui)}}function mi(t){const e=function(t){const e=new Audio,n=[];return t=t.reduce((t,i)=>{if(e.canPlayType(i.type))t.push(i);else if(i.type.startsWith("audio")){const{name:t}=i;n.push(t.slice(t.lastIndexOf(".")))}return t},[]),n.length&&ht({title:"Local files",body:`Can't play audio files with type: ${n.join(", ")}`}),t}(t),n="local-files";ci("local",S(n)||O({id:n,title:"Local files",type:"list",storePlaylist:Fn.getSetting(n,"storePlaylist")}),e,li)}function fi(t){return new Promise(e=>{t.file(e)})}function pi(t){return new Promise(e=>{const n=t.createReader(),i=[];!function t(){n.readEntries(async n=>{if(n.length>0){for(const t of n)if(t.isFile){const e=await fi(t);i.push(e)}else if(t.isDirectory){const e=await pi(t);i.push(...e)}t()}else e(i)})}()})}window.addEventListener("drop",t=>{const{files:e,items:n}=t.dataTransfer;if(t.preventDefault(),e.length)if(n&&n.length&&n[0].webkitGetAsEntry){const t=[],e=[];ht({id:"js-upload-notice",body:'\n                    <div class="upload-notice">\n                        <img src="./assets/images/spinner.svg" alt="">\n                        <span>Uploading...</span>\n                    </div>\n                '});for(const i of n){const n=i.webkitGetAsEntry();n.isDirectory?e.push(pi(n)):n.isFile&&t.push(i.getAsFile())}Promise.all(e).then(e=>{mi([...e.flat().concat(t)])}).catch(t=>{console.log(t)}).finally(()=>{document.getElementById("js-upload-notice").remove()})}else mi([...e])}),window.addEventListener("dragover",t=>{t.preventDefault()});const yi=[];let vi,gi;function bi(t){gi.volume=t}function hi(t){gi.currentTime=t}const wi=1,ki=2,Ei=3;let Li=!1,Ii=null,$i=!1,ji=null,Ti=!1;function xi(t){let{data:e}=t;const n=U();n&&"youtube"===n.player&&(e===wi?(Ti||Ci(!1),Ti=!1,d("track-start",Ii.getCurrentTime())):e===ki?(Ti||Ci(!0),Ti=!1,tn()):e===Ei?(Ze.stop(),Qe()):tn())}function Bi(){const{id:t,volume:e,startTime:n}=ji;Li=!0,"number"==typeof n?(Mi(e),Ii.cueVideoById(t,n),$i=!0):Oi(t,e)}function Ai(t){let e="";if(100===t.data?e="Video is either removed or marked as private":101!==t.data&&150!==t.data||(e="The owner of the requested video does not allow it to be played in embedded players"),console.log(t),e){const t=_(),n=U(),{name:i}=F(t,1);n.name===i?Fi(n):Ni(),ht({title:`Cannot play ${n.name}`,body:e})}}function Si(){Ii=new YT.Player("js-yt-player",{playerVars:{autoplay:0,disablekb:1,controls:0,fs:0,iv_load_policy:3},events:{onReady:Bi,onStateChange:xi,onError:Ai}})}function Oi(t,e,n){if(Li)return Mi(e),void Ii.loadVideoById(t,n);ji={id:t,volume:e,startTime:n},window.onYouTubeIframeAPIReady=Si,i.load({src:"https://www.youtube.com/iframe_api"})}function Mi(t){Li&&Ii.setVolume(100*t)}let Ri=!0;const Pi=function(){function t(){return JSON.parse(localStorage.getItem("track"))||{}}function e(t){localStorage.setItem("track",JSON.stringify(t))}function n(){localStorage.removeItem("track")}return{getTrack:t,removeTrack:n,saveTrack:e,updateTrack:function(n){e(Object.assign(t(),n))},initTrack:function(){const e=t();if(!e)return;const{playlistId:i,currentTime:o,name:s}=e,a=W(i,s);a?(K(i,g("shuffle"),a.index),Ui(a,i,{startTime:o}),mn(a,o)):n()}}}();function Hi(){return Ri}function Ci(t){Ri="boolean"==typeof t?t:!Ri,Ri&&(ot(),Ze.stop()),Vi(Ri),Gi()}async function _i(t,e,n){let{scrollToTrack:i,startTime:o}=n;const{rendered:s}=R(e);if(t.needsMetadata){Qe(),await di(t);const{_id:n,tracks:i,type:o}=S(e);ko(t.index,e).innerHTML=po(t,e,o),Dt(document.querySelector("[data-entry-id=local-files]"),i),Ro({action:"update-tracks",playlist:{_id:n,tracks:i}}),delete t.needsMetadata}Wn(t),pn(t.duration,t.durationInSeconds),Fe.classList.add("visible"),C(e),N(t.index,e),q(t),s&&-1!==t.index&&(Eo(t.index,e),i&&$o(e)),void 0===o?(Ri=!1,Gi(),Qe(),Vi(Ri)):Ri=!0}function Vi(t){nn(document.getElementById("js-play-btn"),t),jo(t)}function qi(t){let{player:e}=t;"native"===e?Ri?gi.play():gi.pause():"youtube"===e&&function(t){Li&&(Ti=!0,$i=!1,t?Ii.playVideo():Ii.pauseVideo())}(Ri),Ci()}async function Ui(t,e,n){void 0===n&&(n={});const i=g("volume");await _i(t,e,n),"native"===t.player?function(t,e,n){vi=URL.createObjectURL(t.audioTrack),gi=new Audio(vi),gi.onplaying=function(){d("track-start",gi.currentTime)},gi.onerror=function(t){const e=U();yi.includes(e.name)?(Fi(e),yi.length=0):(tn(),yi.push(e.name),Ni()),ht({title:`Cannot play ${e.name}`,body:"Its path or name might have changed"}),console.log(t)},bi(e),"number"!=typeof n?gi.play():hi(n)}(t,i,n.startTime):"youtube"===t.player&&Oi(t.id,i,n.startTime)}function Di(){const t=U();t?qi(t):Wi("direction",0,eo())}function Wi(t,e,n,i){if(!n)return;const o=g("shuffle"),s=U(),{shuffled:a}=R(n);if(s&&(jo(!0),Lo(),an(),Ki(s)),"index"===t){const{tracks:t}=S(n),i=t[e];K(n,o,i.index),Ui(i,n)}else if("direction"===t){let t=null,r=!1;if(Y().length&&a===o||(K(n,o),o&&(r=!0)),navigator.onLine)t=F(n,e);else{const i=[];for(;;){const o=F(n,0===e?1:e);if(i.includes(o.index)){ht({body:"Can't play tracks from YouTube white offline"});break}if("youtube"!==o.player){t=o;break}i.push(o.index),N(o.index,n)}}t?(r&&z(t.index),Ui(t,n,{scrollToTrack:"auto"!==i})):Xi(s)}}function Ni(t){Wi("direction",1,_(),t)}function Yi(){Wi("direction",-1,_())}function zi(t){let{currentTarget:e,detail:n,target:i}=t;const o=eo(),s=a("data-btn",i,e),r=a("data-index",i,e);if(!r||!r.elementRef.classList.contains("disabled"))if(2===n&&r&&!s)Wi("index",r.attrValue,o);else if(s){const t=parseInt(r.attrValue,10),e=U(),n=_();e&&n===o&&t===e.index?qi(e):Wi("index",t,o)}}function Ki(t){let{player:e}=t;"native"===e?(gi.pause(),gi.onplaying=null,gi.onerror=null,gi.currentTime=0,gi=null,vi&&(URL.revokeObjectURL(vi),vi=null)):"youtube"===e&&Li&&(tn(),Ii.stopVideo(),$i=!1)}function Fi(t){t&&Ki(t),Xi(t)}function Xi(t){Ri=!0,Pi.removeTrack(),pn(),Fe.classList.remove("visible"),Nn(),q(),C(),ot(),t&&(Vi(Ri),Lo(),an(),tn())}function Ji(t,e){Ze.stop(),"native"===t?hi(e):"youtube"===t&&function(t){Li&&($i?Ii.cueVideoById(ji.id,t):Ii.seekTo(t,!0))}(e)}function Gi(t){void 0===t&&(t=eo());const e=Hi(),n=S(t);let i="Veery";if(e)n&&(i=`${n.title} | ${i}`);else{const{artist:t,name:e,title:n}=U();i=`${t&&n?`${t} - ${n}`:e} | ${i}`}document.title=i}window.addEventListener("track-start",t=>{let{detail:e}=t;const n=_(),{name:i,duration:o,durationInSeconds:s}=U();!function(t){const e=it(t);ot(),e.insertAdjacentHTML("beforeend",p({iconId:"volume",elementId:"js-active-playlist-icon",className:"active-playlist-icon"}))}(n),Pi.saveTrack({name:i,playlistId:n}),Ze.start({currentTime:Math.floor(e),duration:o,durationInSeconds:s}),tn()}),window.addEventListener("track-end",()=>{const t=U(),e=g("playback");"track-once"!==e&&("playlist-once"!==e||x!==Y().length-1)?(Pi.removeTrack(),"repeat"!==e?Ni("auto"):Ui(t,_())):Fi(t)});const Zi=document.getElementById("js-tab-header"),Qi=matchMedia("(max-width: 540px)");let to="";function eo(){return to}function no(){return S(to)}function io(t){return document.getElementById(`js-tab-${t}`)}function oo(t){const e=S(t),{rendered:n}=R(t);n||function(t){const e=function(t){const e=bo(t);return`<div id="js-tab-${t.id}" class="tab" tabindex="0">${e}</div>`}(t);document.getElementById("js-tabs").insertAdjacentHTML("beforeend",e),P(t.id,{rendered:!0}),t.tracks.length&&(ho(t.id),ro(t.id))}(e),Io(t),"list"===e.type&&Qi.matches?xo(e,"grid"):To(e.type),Ne(e),ye(e),Ve(),e.tracks.length&&io(t).addEventListener("click",zi)}Zi.addEventListener("click",t=>{let{currentTarget:e,target:n}=t;const i=a("data-item",n,e);if(!i)return;const o=no(),s=i.attrValue;"move-to"===s?et("js-move-to-panel",oe,{playlistId:o.id,element:i.elementRef}):"list"!==s&&"grid"!==s||s===o.type?"sorting"===s?et("js-sort-panel",Ye,{sortedBy:o.sortedBy,element:i.elementRef}):"order"===s&&o.sortedBy?function(t){We(t,t.sortedBy),De(t.order)}(o):"sidebar"===s&&document.getElementById("js-sidebar-container").classList.remove("hidden"):xo(o,s)}),window.addEventListener("route-change",t=>{let{detail:{isPlaylistTab:e,tabId:n}}=t;const i=io(to);s(".sidebar-entry.active","active"),s(".tab.active","active"),function(t){void 0===t&&(t=""),to=t}(e?n:""),i&&i.removeEventListener("click",zi),e?(oo(n),Zi.classList.add("playlist-tab-active")):Zi.classList.remove("playlist-tab-active"),Gi(n),io(n).classList.add("active"),"not-found"!==n&&it(n).classList.add("active")}),Qi.onchange=function(t){let{matches:e}=t;const n=no();e&&n&&"list"===n.type&&xo(n,"grid")};const so={};function ao(t){t.forEach(t=>{let{isIntersecting:e,target:n}=t;const i=!n.childElementCount;e&&i?function(t){const{id:e,tracks:n,type:i}=no(),o=n[t.getAttribute("data-index")];t.innerHTML=po(o,e,i)}(n):e||i||n.contains(document.activeElement)||function(t){const e=t.querySelector(".artwork");e&&URL.revokeObjectURL(e.src),t.innerHTML=""}(n)})}function ro(t){if(!IntersectionObserver||so[t])return;so[t]=new IntersectionObserver(ao,{root:io(t)});const{children:e}=uo(t);!function(t,e){e.forEach(e=>{so[t].observe(e)})}(t,Array.from(e))}function lo(t){so[t]&&(so[t].disconnect(),delete so[t])}let co=null;function uo(t){return document.getElementById(`js-${t}`)}function mo(){if(co)return co.querySelector(".btn-icon")}function fo(t){if(eo()!==_())return en(!0);const e=U(),n=Hi();return e&&e.index===t?en(n):en(!0)}function po(t,e,n){return"list"===n?function(t,e){const{sortOrder:n}=R(e),i=n.indexOf(t.index),{title:o,id:s}=fo(t.index);return`\n        <span class="list-item-first-col">\n            <span class="list-item-index">${i+1}</span>\n            <button class="btn btn-icon track-play-pause-btn" data-btn="play" title="${o}">\n                ${p({iconId:s})}\n            </button>\n        </span>\n        <span class="list-item-col">${t.title}</span>\n        <span class="list-item-col">${t.artist}</span>\n        <span class="list-item-col">${t.album}</span>\n        <span class="list-item-last-col">${t.duration}</span>\n    `}(t,e):function(t){const{title:e,id:n}=fo(t.index);return`\n        <div class="artwork-container grid-item-thumbnail" tabindex="-1">\n            <button class="btn btn-icon track-play-pause-btn artwork-container-btn" data-btn="play" title="${e}">\n                ${p({iconId:n})}\n            </button>\n            <img src="${u(t.picture)}" class="artwork" alt="">\n        </div>\n        ${function(t){let e=t.name;t.artist&&t.title&&(e=`\n            <div class="track-title">${t.title}</div>\n            <div class="track-artist">${t.artist} ${t.album?`- ${t.album}`:""}</div>\n        `);return`<div class="track-info">${e}</div> `}(t)}\n        <div class="grid-item-duration">${t.duration}</div>\n    `}(t)}function yo(t){let{index:e,player:n}=t;return`<li class="list-item track${"youtube"!==n||navigator.onLine?"":" disabled"}" data-index="${e}" tabindex="0"></li>`}function vo(t){let{index:e,player:n}=t;return`<li class="grid-item track${"youtube"!==n||navigator.onLine?"":" disabled"}" data-index="${e}" tabindex="0"></li>`}function go(t,e,n){return e.reduce((e,i)=>e+n(t[i]),"")}function bo(t){return t.tracks.length?function(t){let{id:e,type:n,tracks:i}=t;const{sortOrder:o}=R(e);return"list"===n?function(t,e){return`\n        <ul class="list-view-header">\n            <li class="list-item-first-col">#</li>\n            <li>Title</li>\n            <li>Artist</li>\n            <li>Album</li>\n            <li class="list-item-last-col">Duration</li>\n        </ul>\n        <ul id="js-${t}" class="playlist-view">${e}</ul>\n    `}(e,go(i,o,yo)):function(t,e){return`<ul id="js-${t}" class="playlist-view grid-view">${e}</ul>`}(e,go(i,o,vo))}(t):'<p class="playlist-message">This playlist is empty</p>'}function ho(t){if(_()!==t)return;const e=U();e&&-1!==e.index&&Eo(e.index,t)}function wo(t){var e;io(t.id).innerHTML=bo(t),t.tracks.length?(ho(t.id),e=t.id,so[e]&&lo(e),ro(e),ye(t)):lo(t.id)}function ko(t,e){const{sortOrder:n}=R(e),i=n.indexOf(t);return document.getElementById(`js-${e}`).children[i]}function Eo(t,e){co=ko(t,e),co.classList.add("playing")}function Lo(){co&&(co.classList.remove("playing"),co=null)}function Io(t){_()===t&&co&&$o(t)}function $o(t){requestAnimationFrame(()=>{const e=io(t),{offsetHeight:n,offsetTop:i}=co,{clientHeight:o,scrollTop:s}=e;(i-n<s||i>s+o)&&(e.scrollTop=i-o/2)})}function jo(t){const e=mo();e&&nn(e,t)}function To(t){const e=document.getElementById("js-list-toggle-btn"),n=document.getElementById("js-grid-toggle-btn");"list"===t?(e.classList.add("active"),n.classList.remove("active")):(n.classList.add("active"),e.classList.remove("active"))}function xo(t,e){t.type=e,Ro({action:"change-type",playlist:{_id:t._id,type:e}}),wo(t),To(e)}function Bo(t){var e,n,i;P(t.id,{initialized:!0}),e=t.title,n=t.id,document.getElementById("js-sidebar-entries").insertAdjacentHTML("beforeend",`\n        <li id="js-sidebar-entry-${n}" class="sidebar-entry">\n            <a href="./#/playlist/${n}" class="sidebar-link" data-link>${e}</a>\n        </li>\n    `),function(t){const e=Ht(),n=H(t.tracks),i=p({iconId:"link"}),o=t.url?`<a href="${t.url}"\n            class="btn btn-icon pl-entry-btn" target="_blank"\n            title="Open playlist on YouTube">\n            ${i}\n        </a>\n    `:"",s=t.url?Ct({disabled:!navigator.onLine,action:"sync",title:"Synchronize playlist",iconId:"sync"}):"",a=t.url?`\n        <div class="pl-entry-panel-container">\n            ${Ct({action:"settings",title:"Settings",iconId:"settings"})}\n        </div>\n    `:"",r=Ct({action:"remove",title:"Remove playlist",iconId:"trash"}),l=p({iconId:"edit",className:"pl-entry-input-icon"}),c=t.storePlaylist?"":p({iconId:"alert",className:"pl-entry-stats-item",title:"This playlist will not be stored"}),d=t.isPrivate?p({iconId:"lock",className:"pl-entry-stats-item",title:t.user?`Private to ${t.user.name}`:"Private"}):"";e.insertAdjacentHTML("beforeend",`\n        <li class="pl-entry" data-entry-id=${t.id}>\n            ${Vt(t.tracks)}\n            <div class="pl-entry-content">\n                <div class="pl-entry-input-container" data-action="edit">\n                    <input type="text" class="input pl-entry-input" value="${t.title}">\n                    ${l}\n                </div>\n                <div class="pl-entry-footer">\n                    <div class="pl-entry-stats">\n                        ${c}\n                        ${d}\n                        <span class="pl-entry-stats-item track-count">${t.tracks.length} tracks</span>\n                        <span class="pl-entry-stats-item playlist-duration">${_t(n)}</span>\n                    </div>\n                    ${o}\n                    ${s}\n                    ${a}\n                    ${r}\n                </div>\n            </div>\n        </li>\n    `)}(t),X(t),G(t),k(i=`playlist/${t.id}`)||w.push(i)}function Ao(t){let{id:e,_id:n}=t;V(e)&&Fi(U()),function(t){const e=io(t);e&&(lo(t),o(e))}(e),function(t){delete I[t],delete $[t]}(e),function(t){o(it(t))}(e),function(t){w=w.filter(e=>!e.includes(t))}(e),Ro({action:"remove",playlist:{_id:n}})}function So(t,e){const{initialized:n,rendered:i}=R(t.id);var o;e.length&&(t.tracks=t.tracks.concat(e)),n?(X(t),V(t.id)&&K(t.id,g("shuffle")),G(t),D(t.id),Dt(t.id,t.tracks),i&&wo(t),Ro({action:"add-tracks",playlist:{_id:t._id,tracks:e}})):(Bo(t),o="local-files",window.location.hash.includes(o)&&!i&&L(),t.storePlaylist&&Ro({action:"add",playlist:t}))}function Oo(t){const e=O({title:t.target.title.value,id:Math.random().toString(36).slice(2),storePlaylist:!0,type:"grid"});Bo(e),Ro({action:"add",playlist:e}),t.preventDefault(),t.target.reset()}window.addEventListener("connectivity-status",t=>{let{detail:e}=t;A().forEach(t=>{const n=uo(t.id),{sortOrder:i}=R(t.id);n&&t.tracks.forEach(t=>{if("youtube"===t.player){const o=i.indexOf(t.index);n.children[o].classList.toggle("disabled",!e)}})})});const Mo=new Worker("./ww.js");function Ro(t){("add"===t.action||t.playlist._id)&&Mo.postMessage(t)}Mo.onmessage=function(t){let{data:{action:e,payload:n}}=t;"init"===e?(n.forEach(t=>{Bo(O(t))}),Yt(n.filter(t=>t.syncOnInit)),Pi.initTrack(),L()):"update"===e&&M(n.id,n)},Mo.onerror=function(t){console.log(t)},"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(t=>{t.onupdatefound=()=>{const e=t.installing;e.onstatechange=()=>{"installed"===e.state&&navigator.serviceWorker.controller&&d("sw-state-change","update")}}}).catch(console.log)},93:function(t,e,n){},94:function(t,e,n){}});